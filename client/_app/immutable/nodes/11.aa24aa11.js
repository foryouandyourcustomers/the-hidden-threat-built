import{r as gr,E as ni,H as ri,I as ii,s as ie,n as se,o as mr,l as Gt,m as Ht,c as K,p as si,J as oi,d as Se,h as ai,u as ke,g as Ie,e as Ee}from"../chunks/scheduler.3df9b730.js";import{q as k,p as T,S as ae,i as le,e as L,F as Jt,s as F,t as R,c as x,a as H,G as Yt,d as $,f as C,b as G,n as j,g as S,h as P,j as oe,H as vr,B as ne,z as re,v as ue,l as V,m as U,o as W,r as X,I as Ne,A as Qe,y as Oe,J as li,K as ci,x as Ae,w as Zt,k as ct,E as St,L as en}from"../chunks/index.06da1297.js";import{r as yr,w as ui}from"../chunks/index.9b15924c.js";import{g as fi,B as Pe}from"../chunks/Button.b63fec9a.js";function te(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function br(n,e){k(n,1,1,()=>{e.delete(n.key)})}function wr(n,e,t,r,s,o,l,f,u,d,g,i){let a=n.length,c=o.length,_=a;const p={};for(;_--;)p[n[_].key]=_;const m=[],h=new Map,y=new Map,b=[];for(_=c;_--;){const A=i(s,o,_),B=t(A);let O=l.get(B);O?r&&b.push(()=>O.p(A,e)):(O=d(B,A),O.c()),h.set(B,m[_]=O),B in p&&y.set(B,Math.abs(_-p[B]))}const v=new Set,w=new Set;function I(A){T(A,1),A.m(f,g),l.set(A.key,A),g=A.first,c--}for(;a&&c;){const A=m[c-1],B=n[a-1],O=A.key,ee=B.key;A===B?(g=A.first,a--,c--):h.has(ee)?!l.has(O)||v.has(O)?I(A):w.has(ee)?a--:y.get(O)>y.get(ee)?(w.add(O),I(A)):(v.add(ee),a--):(u(B,l),a--)}for(;a--;){const A=n[a];h.has(A.key)||u(A,l)}for(;c;)I(m[c-1]);return gr(b),m}const di=!1,W_=Object.freeze(Object.defineProperty({__proto__:null,ssr:di},Symbol.toStringTag,{value:"Module"}));function _i(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function pi(){const n=_i();if(n.__xstate__)return n.__xstate__}const hi=n=>{if(typeof window>"u")return;const e=pi();e&&e.register(n)};let pe=function(n){return n.After="xstate.after",n.DoneState="done.state",n.DoneInvoke="done.invoke",n.ErrorExecution="error.execution",n.ErrorCommunication="error.communication",n.ErrorPlatform="error.platform",n.ErrorCustom="xstate.error",n}({});pe.After;pe.DoneState;const gi=pe.ErrorExecution,mi=pe.ErrorPlatform;pe.ErrorCustom;const Le=".",vi="",$r="",yi="#",bi="*",Ar="xstate.init",tn=new WeakMap;function ge(n,e,t){let r=tn.get(n);return r?e in r||(r[e]=t()):(r={[e]:t()},tn.set(n,r)),r[e]}function wi(n,e,t,{sendId:r}){const s=typeof r=="function"?r(t):r;return[e,s]}function $i(n,e){n.self.cancel(e)}function Ai(n){function e(t){}return e.type="xstate.cancel",e.sendId=n,e.resolve=wi,e.execute=$i,e}class nn{constructor(e){this._process=e,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}prepend(e){if(!this._current){this.enqueue(e);return}this._current={value:e,next:this._current}}enqueue(e){const t={value:e,next:null};if(this._current){this._last.next=t,this._last=t;return}this._current=t,this._last=t,this._active&&this.flush()}flush(){for(;this._current;){const e=this._current;this._process(e.value),e===this._current&&(this._current=this._current.next)}this._last=null}}const Ti=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")();function Tr(n,e){const t=kt(n),r=kt(e);return typeof r=="string"?typeof t=="string"?r===t:!1:typeof t=="string"?t in r:Object.keys(t).every(s=>s in r?Tr(t[s],r[s]):!1)}function Sr(n){try{return We(n)?n:n.toString().split(Le)}catch{throw new Error(`'${n}' is not a valid state path.`)}}function Si(n){return typeof n=="object"&&"value"in n&&"context"in n&&"event"in n}function kt(n){if(Si(n))return n.value;if(We(n))return rn(n);if(typeof n!="string")return n;const e=Sr(n);return rn(e)}function rn(n){if(n.length===1)return n[0];const e={};let t=e;for(let r=0;r<n.length-1;r++)if(r===n.length-2)t[n[r]]=n[r+1];else{const s=t;t={},s[n[r]]=t}return e}function sn(n,e){const t={},r=Object.keys(n);for(let s=0;s<r.length;s++){const o=r[s];t[o]=e(n[o],o,n,s)}return t}function It(n){return[].concat(...n)}function kr(n){return We(n)?n:[n]}function _e(n){return n===void 0?[]:kr(n)}function Ir(n,e,t){if(typeof n=="function")return n({context:e,event:t});const r={},s={context:e,event:t};for(const o of Object.keys(n)){const l=n[o];typeof l=="function"?r[o]=l(s):r[o]=l}return r}function We(n){return Array.isArray(n)}function ki(n){return typeof n.type=="string"&&(n.type===gi||n.type.startsWith(mi))}function $e(n){return kr(n).map(e=>typeof e>"u"||typeof e=="string"?{target:e}:e)}function Er(n){if(!(n===void 0||n===vi))return _e(n)}function Ii(n,e){if(typeof n=="object"){if("src"in n)return n;if("transition"in n)return{id:e,src:n}}return{id:e,src:n}}function Ei(n,e,t){const r=()=>{},s=typeof n=="object",o=s?n:null;return{next:((s?n.next:n)||r).bind(o),error:((s?n.error:e)||r).bind(o),complete:((s?n.complete:t)||r).bind(o)}}function Oi(n,e){return`${n}:invocation[${e}]`}function tt(n){return n?"transition"in n?{src:n,input:void 0}:n:void 0}const Et="xstate.stop";function Pi(){let n=0;const e=new Map,t=new Map,r=new WeakMap;return{_bookId:()=>`x:${n++}`,_register:(o,l)=>(e.set(o,l),o),_unregister:o=>{e.delete(o.sessionId);const l=r.get(o);l!==void 0&&(t.delete(l),r.delete(o))},get:o=>t.get(o),_set:(o,l)=>{const f=t.get(o);if(f&&f!==l)throw new Error(`Actor with system ID '${o}' already exists.`);t.set(o,l),r.set(l,o)}}}let Z=function(n){return n[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.Stopped=2]="Stopped",n}({});const Mi={deferEvents:!0,clock:{setTimeout:(n,e)=>setTimeout(n,e),clearTimeout:n=>clearTimeout(n)},logger:console.log.bind(console),devTools:!1};class ji{constructor(e,t){this.logic=e,this._state=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new nn(this._process.bind(this)),this.delayedEventsMap={},this.observers=new Set,this.logger=void 0,this.status=Z.NotStarted,this._parent=void 0,this.ref=void 0,this._actorContext=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];const r={...Mi,...t},{clock:s,logger:o,parent:l,id:f,systemId:u}=r,d=this;this.system=(l==null?void 0:l.system)??Pi(),u&&(this._systemId=u,this.system._set(u,this)),this.sessionId=this.system._bookId(),this.id=f??this.sessionId,this.logger=o,this.clock=s,this._parent=l,this.options=r,this.src=r.src,this.ref=this,this._actorContext={self:d,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:g=>{this._deferred.push(g)},system:this.system,stopChild:g=>{if(g._parent!==this)throw new Error(`Cannot stop child actor ${g.id} of ${this.id} because it is not a child`);g._stop()}},this.send=this.send.bind(this),this._initState()}_initState(){var e;this._state=this.options.state?this.logic.restoreState?this.logic.restoreState(this.options.state,this._actorContext):this.options.state:this.logic.getInitialState(this._actorContext,(e=this.options)==null?void 0:e.input)}update(e){var o,l,f,u,d;this._state=e;const t=this.getSnapshot();let r;for(;r=this._deferred.shift();)r();for(const g of this.observers)(o=g.next)==null||o.call(g,t);const s=(f=(l=this.logic).getStatus)==null?void 0:f.call(l,e);switch(s==null?void 0:s.status){case"done":this._stopProcedure(),this._doneEvent=ls(this.id,s.data),(u=this._parent)==null||u.send(this._doneEvent),this._complete();break;case"error":this._stopProcedure(),(d=this._parent)==null||d.send(_t(this.id,s.data)),this._error(s.data);break}}subscribe(e,t,r){var o;const s=Ei(e,t,r);return this.observers.add(s),this.status===Z.Stopped&&((o=s.complete)==null||o.call(s),this.observers.delete(s)),{unsubscribe:()=>{this.observers.delete(s)}}}start(){return this.status===Z.Running?this:(this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this.status=Z.Running,this.logic.start&&this.logic.start(this._state,this._actorContext),this.update(this._state),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this)}_process(e){try{const t=this.logic.transition(this._state,e,this._actorContext);this.update(t),e.type===Et&&(this._stopProcedure(),this._complete())}catch(t){if(this.observers.size>0)this.observers.forEach(r=>{var s;(s=r.error)==null||s.call(r,t)}),this.stop();else throw t}}_stop(){return this.status===Z.Stopped?this:(this.mailbox.clear(),this.status===Z.NotStarted?(this.status=Z.Stopped,this):(this.mailbox.enqueue({type:Et}),this))}stop(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){var e;for(const t of this.observers)(e=t.complete)==null||e.call(t);this.observers.clear()}_error(e){var t;for(const r of this.observers)(t=r.error)==null||t.call(r,e);this.observers.clear()}_stopProcedure(){if(this.status!==Z.Running)return this;for(const e of Object.keys(this.delayedEventsMap))this.clock.clearTimeout(this.delayedEventsMap[e]);return this.mailbox.clear(),this.mailbox=new nn(this._process.bind(this)),this.status=Z.Stopped,this.system._unregister(this),this}send(e){if(typeof e=="string")throw new Error(`Only event objects may be sent to actors; use .send({ type: "${e}" }) instead`);if(this.status!==Z.Stopped){if(this.status!==Z.Running&&!this.options.deferEvents)throw new Error(`Event "${e.type}" was sent to uninitialized actor "${this.id}". Make sure .start() is called for this actor, or set { deferEvents: true } in the actor options.
Event: ${JSON.stringify(e)}`);this.mailbox.enqueue(e)}}delaySend({event:e,id:t,delay:r,to:s}){const o=this.clock.setTimeout(()=>{s?s.send(e):this.send(e)},r);t&&(this.delayedEventsMap[t]=o)}cancel(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]}attachDevTools(){const{devTools:e}=this.options;e&&(typeof e=="function"?e:hi)(this)}toJSON(){return{id:this.id}}getPersistedState(){var e,t;return(t=(e=this.logic).getPersistedState)==null?void 0:t.call(e,this._state)}[Ti](){return this}getSnapshot(){return this.logic.getSnapshot?this.logic.getSnapshot(this._state):this._state}}function Me(n,e){return new ji(n,e)}function Di(n,e,t,{id:r,systemId:s,src:o,input:l}){const f=tt(e.machine.implementations.actors[o]);let u;if(f){const d=l||f.input;u=Me(f.src,{id:r,src:o,parent:n==null?void 0:n.self,systemId:s,input:typeof d=="function"?d({context:e.context,event:t.event,self:n==null?void 0:n.self}):d})}return[be(e,{children:{...e.children,[r]:u}}),{id:r,actorRef:u}]}function Li(n,{id:e,actorRef:t}){t&&n.defer(()=>{var r;if(t.status!==Z.Stopped)try{(r=t.start)==null||r.call(t)}catch(s){n.self.send(_t(e,s));return}})}function xi({id:n,systemId:e,src:t,input:r}){function s(o){}return s.type="xstate.invoke",s.id=n,s.systemId=e,s.src=t,s.input=r,s.resolve=Di,s.execute=Li,s}function Ri(n){return{type:"xstate.boolean",params:{op:"not"},children:[nt(n)],predicate:({evaluate:e,guard:t,context:r,event:s,state:o})=>!e(t.children[0],r,s,o)}}function Ft(n,e,t,r){var l,f;const{machine:s}=r,o=((f=(l=s==null?void 0:s.implementations)==null?void 0:l.guards)==null?void 0:f[n.type])??n.predicate;if(!o)throw new Error(`Guard '${n.type}' is not implemented.'.`);return o({context:e,event:t,state:r,guard:n,evaluate:Ft})}function nt(n,e){var r,s;if(typeof n=="string"){const o=e==null?void 0:e(n);return typeof o=="function"?{type:n,predicate:o,params:{type:n}}:o||{type:n,params:{type:n}}}if(typeof n=="function")return{type:n.name,predicate:n,params:{type:n.name,name:n.name}};const t=e==null?void 0:e(n.type);return typeof t=="function"?{type:n.type,params:n.params||n,children:(r=n.children)==null?void 0:r.map(o=>nt(o,e)),predicate:(e==null?void 0:e(n.type))||n.predicate}:t||{type:n.type,params:n.params||n,children:(s=n.children)==null?void 0:s.map(o=>nt(o,e)),predicate:n.predicate}}function Gi(n,e,t){const r=n[0].machine,s=n.find(o=>o.type==="final"&&o.parent===r.root);return s&&s.output?Ir(s.output,e,t):void 0}const ut=n=>n.type==="atomic"||n.type==="final";function ve(n){return Object.values(n.states).filter(e=>e.type!=="history")}function Ct(n,e){const t=[];let r=n.parent;for(;r&&r!==e;)t.push(r),r=r.parent;return t}function Ve(n){const e=new Set(n),t=new Set(n),r=Pr(t);for(const s of e)if(s.type==="compound"&&(!r.get(s)||!r.get(s).length))on(s).forEach(o=>t.add(o));else if(s.type==="parallel"){for(const o of ve(s))if(o.type!=="history"&&!t.has(o))for(const l of on(o))t.add(l)}for(const s of t){let o=s.parent;for(;o;)t.add(o),o=o.parent}return t}function Or(n,e){const t=e.get(n);if(!t)return{};if(n.type==="compound"){const s=t[0];if(s){if(ut(s))return s.key}else return{}}const r={};for(const s of t)r[s.key]=Or(s,e);return r}function Pr(n){const e=new Map;for(const t of n)e.has(t)||e.set(t,[]),t.parent&&(e.has(t.parent)||e.set(t.parent,[]),e.get(t.parent).push(t));return e}function Mr(n,e){const t=Ve(e);return Or(n,Pr(t))}function ft(n,e=n[0].machine.root){return e.type==="compound"?ve(e).some(t=>t.type==="final"&&n.includes(t)):e.type==="parallel"?ve(e).every(t=>ft(n,t)):!1}const je=n=>n[0]===yi;function Hi(n,e){return n.transitions.get(e)||[...n.transitions.keys()].filter(r=>{if(r===bi)return!0;if(!r.endsWith(".*"))return!1;const s=r.split("."),o=e.split(".");for(let l=0;l<s.length;l++){const f=s[l],u=o[l];if(f==="*")return l===s.length-1;if(f!==u)return!1}return!0}).sort((r,s)=>s.length-r.length).flatMap(r=>n.transitions.get(r))}function Fi(n){const e=n.config.after;if(!e)return[];const t=(s,o)=>{const l=typeof s=="function"?`${n.id}:delay[${o}]`:s,f=as(l,n.id);return n.entry.push(os({type:f},{id:f,delay:s})),n.exit.push(Ai(f)),f};return(We(e)?e.map((s,o)=>{const l=t(s.delay,o);return{...s,event:l}}):Object.keys(e).flatMap((s,o)=>{const l=e[s],f=typeof l=="string"?{target:l}:l,u=isNaN(+s)?s:+s,d=t(u,o);return _e(f).map(g=>({...g,event:d,delay:u}))})).map(s=>{const{delay:o}=s;return{...he(n,s.event,s),delay:o}})}function he(n,e,t){const r=Er(t.target),s=t.reenter??!1,{guards:o}=n.machine.implementations,l=jr(n,r),f={...t,actions:_e(t.actions),guard:t.guard?nt(t.guard,u=>o[u]):void 0,target:l,source:n,reenter:s,eventType:e,toJSON:()=>({...f,source:`#${n.id}`,target:l?l.map(u=>`#${u.id}`):void 0})};return f}function Ci(n){const e=new Map;if(n.config.on)for(const t of Object.keys(n.config.on)){if(t===$r)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');const r=n.config.on[t];e.set(t,$e(r).map(s=>he(n,t,s)))}if(n.config.onDone){const t=String(Pt(n.id));e.set(t,$e(n.config.onDone).map(r=>he(n,t,r)))}for(const t of n.invoke){if(t.onDone){const r=`done.invoke.${t.id}`;e.set(r,$e(t.onDone).map(s=>he(n,r,s)))}if(t.onError){const r=`error.platform.${t.id}`;e.set(r,$e(t.onError).map(s=>he(n,r,s)))}if(t.onSnapshot){const r=`xstate.snapshot.${t.id}`;e.set(r,$e(t.onSnapshot).map(s=>he(n,r,s)))}}for(const t of n.after){let r=e.get(t.eventType);r||(r=[],e.set(t.eventType,r)),r.push(t)}return e}function Bi(n,e){if(typeof e=="string"||We(e)){const t=_e(e).map(o=>{const l=typeof o=="string"?je(o)?n.machine.getStateNodeById(o):n.states[o]:o;if(!l)throw new Error(`Initial state node "${o}" not found on parent state node #${n.id}`);if(!ye(l,n))throw new Error(`Invalid initial target: state node #${l.id} is not a descendant of #${n.id}`);return l}),r=jr(n,t),s={source:n,actions:[],eventType:null,reenter:!1,target:r,toJSON:()=>({...s,source:`#${n.id}`,target:r?r.map(o=>`#${o.id}`):void 0})};return s}return he(n,"__INITIAL__",{target:_e(e.target).map(t=>typeof t=="string"?je(t)?t:`${Le}${t}`:t),actions:e.actions})}function jr(n,e){if(e!==void 0)return e.map(t=>{if(typeof t!="string")return t;if(je(t))return n.machine.getStateNodeById(t);const r=t[0]===Le;if(r&&!n.parent)return it(n,t.slice(1));const s=r?n.key+t:t;if(n.parent)try{return it(n.parent,s)}catch(o){throw new Error(`Invalid transition definition for state node '${n.id}':
${o.message}`)}else throw new Error(`Invalid target: "${t}" is not a valid target from the root node. Did you mean ".${t}"?`)})}function Dr(n){const e=Er(n.target);return e?e.map(t=>typeof t=="string"?it(n.parent,t):t):n.parent.initial.target}function rt(n){return n.type==="history"}function on(n){const e=new Set;function t(r){if(!e.has(r)){if(e.add(r),r.type==="compound")for(const s of r.initial.target){for(const o of Ct(s,n))e.add(o);t(s)}else if(r.type==="parallel")for(const s of ve(r))t(s)}}return t(n),[...e]}function De(n,e){if(je(e))return n.machine.getStateNodeById(e);if(!n.states)throw new Error(`Unable to retrieve child state '${e}' from '${n.id}'; no child states exist.`);const t=n.states[e];if(!t)throw new Error(`Child state '${e}' does not exist on '${n.id}'`);return t}function it(n,e){if(typeof e=="string"&&je(e))try{return n.machine.getStateNodeById(e)}catch{}const t=Sr(e).slice();let r=n;for(;t.length;){const s=t.shift();if(!s.length)break;r=De(r,s)}return r}function Ue(n,e){const t=e instanceof ce?e.value:kt(e);if(typeof t=="string")return[n,n.states[t]];const r=Object.keys(t),s=r.map(o=>De(n,o)).filter(Boolean);return[n.machine.root,n].concat(s,r.reduce((o,l)=>{const f=De(n,l);if(!f)return o;const u=Ue(f,t[l]);return o.concat(u)},[]))}function qi(n,e,t,r){const o=De(n,e).next(t,r);return!o||!o.length?n.next(t,r):o}function Ni(n,e,t,r){const s=Object.keys(e),o=De(n,s[0]),l=Bt(o,e[s[0]],t,r);return!l||!l.length?n.next(t,r):l}function Vi(n,e,t,r){const s=[];for(const o of Object.keys(e)){const l=e[o];if(!l)continue;const f=De(n,o),u=Bt(f,l,t,r);u&&s.push(...u)}return s.length?s:n.next(t,r)}function Bt(n,e,t,r){return typeof e=="string"?qi(n,e,t,r):Object.keys(e).length===1?Ni(n,e,t,r):Vi(n,e,t,r)}function Ui(n){return Object.keys(n.states).map(e=>n.states[e]).filter(e=>e.type==="history")}function ye(n,e){let t=n;for(;t.parent&&t.parent!==e;)t=t.parent;return t.parent===e}function an(n){const e=[];let t=n.parent;for(;t;)e.unshift(t),t=t.parent;return e}function Wi(n,e){const t=new Set(n),r=new Set(e);for(const s of t)if(r.has(s))return!0;for(const s of r)if(t.has(s))return!0;return!1}function Lr(n,e,t){const r=new Set;for(const s of n){let o=!1;const l=new Set;for(const f of r)if(Wi(Ot([s],e,t),Ot([f],e,t)))if(ye(s.source,f.source))l.add(f);else{o=!0;break}if(!o){for(const f of l)r.delete(f);r.add(s)}}return Array.from(r)}function Xi(n){const[e]=n;let t=an(e),r=[];for(const s of n){const o=an(s);r=t.filter(l=>o.includes(l)),t=r,r=[]}return t[t.length-1]}function qt(n,e){if(!n.target)return[];const t=new Set;for(const r of n.target)if(rt(r))if(e[r.id])for(const s of e[r.id])t.add(s);else for(const s of qt({target:Dr(r)},e))t.add(s);else t.add(r);return[...t]}function xr(n,e){const t=qt(n,e);return t?!n.reenter&&n.source.type!=="parallel"&&t.every(s=>ye(s,n.source))?n.source:Xi(t.concat(n.source)):null}function Ot(n,e,t){var s;const r=new Set;for(const o of n)if((s=o.target)!=null&&s.length){const l=xr(o,t);for(const f of e)ye(f,l)&&r.add(f)}return[...r]}function Ye(n,e,t,r,s){const o=new Set(e.configuration);if(!n.length)return e;const l=zi(n,e,o,r,t,s);return be(l,{value:{}})}function zi(n,e,t,r,s,o){const l=[],f={...e.historyValue},u=Lr(n,t,f),d=[...e._internalQueue];o||Qi(u,t,f,l),l.push(...u.flatMap(a=>a.actions)),Ki(r,u,t,l,d,e,f,o);const g=[...t],i=ft(g);if(i){const a=g.sort((c,_)=>_.order-c.order).flatMap(c=>c.exit);l.push(...a)}try{const a=dt(l,r,e,s),c=i?Gi(g,a.context,r):void 0;return d.push(...a._internalQueue),be(e,{configuration:g,historyValue:f,_internalQueue:d,context:a.context,done:i,output:c,children:a.children})}catch(a){throw a}}function Ki(n,e,t,r,s,o,l,f){const u=new Set,d=new Set;Rr(e,l,d,u),f&&d.add(o.machine.root);for(const g of[...u].sort((i,a)=>i.order-a.order)){t.add(g);for(const i of g.invoke)r.push(xi(i));if(r.push(...g.entry),d.has(g))for(const i of d){const a=i.initial.actions;r.push(...a)}if(g.type==="final"){const i=g.parent;if(!i.parent)continue;if(s.push(Pt(i.id,g.output?Ir(g.output,o.context,n):void 0)),i.parent){const a=i.parent;a.type==="parallel"&&ve(a).every(c=>ft([...t],c))&&s.push(Pt(a.id))}}}}function Rr(n,e,t,r){for(const s of n){for(const f of s.target||[])Te(f,e,t,r);const o=xr(s,e),l=qt(s,e);for(const f of l)Ze(f,o,r,e,t)}}function Te(n,e,t,r){if(rt(n))if(e[n.id]){const s=e[n.id];for(const o of s)Te(o,e,t,r);for(const o of s){Ze(o,n.parent,r,e,t);for(const l of t)t.add(l)}}else{const s=Dr(n);for(const o of s)Te(o,e,t,r);for(const o of s){Ze(o,n,r,e,t);for(const l of t)t.add(l)}}else if(r.add(n),n.type==="compound"){t.add(n);const s=n.initial.target;for(const o of s)Te(o,e,t,r);for(const o of s)Ze(o,n,r,e,t)}else if(n.type==="parallel")for(const s of ve(n).filter(o=>!rt(o)))[...r].some(o=>ye(o,s))||Te(s,e,t,r)}function Ze(n,e,t,r,s){const o=Ct(n,e);for(const l of o)if(t.add(l),l.type==="parallel")for(const f of ve(l).filter(u=>!rt(u)))[...t].some(u=>ye(u,f))||Te(f,r,s,t)}function Qi(n,e,t,r){const s=Ot(n,e,t);s.sort((o,l)=>l.order-o.order);for(const o of s)for(const l of Ui(o)){let f;l.history==="deep"?f=u=>ut(u)&&ye(u,o):f=u=>u.parent===o,t[l.id]=Array.from(e).filter(f)}for(const o of s)r.push(...o.exit,...o.invoke.map(l=>Gr(l.id))),e.delete(o)}function dt(n,e,t,r){const{machine:s}=t;let o=be(t,{_internalQueue:[]});for(const l of n){const f=typeof l=="function"?l:s.implementations.actions[typeof l=="string"?l:l.type];if(!f)continue;const u={context:o.context,event:e,self:r==null?void 0:r.self,system:r==null?void 0:r.system,action:typeof l=="string"?{type:l}:l};if(!("resolve"in f)){(r==null?void 0:r.self.status)===Z.Running?f(u):r==null||r.defer(()=>f(u));continue}const d=f,[g,i,a]=d.resolve(r,o,u,f);o=g,"execute"in f&&((r==null?void 0:r.self.status)===Z.Running?d.execute(r,i):r==null||r.defer(d.execute.bind(null,r,i))),a&&(o=dt(a,e,o,r))}return o}function vt(n,e,t){let r=n;const s=[];if(e.type===Et)return r=ln(e,r,t),s.push(r),{state:r,microstates:s};let o=e;if(o.type!==Ar){const l=cn(o,r);r=Ye(l,n,t,o,!1),s.push(r)}for(;!r.done;){let l=Ji(r,o);if(l.length)r=Ye(l,r,t,o,!1),s.push(r);else if(r._internalQueue.length){o=r._internalQueue[0];const f=cn(o,r);r=Ye(f,r,t,o,!1),r._internalQueue.shift(),s.push(r)}else break}return r.done&&ln(o,r,t),{state:r,microstates:s}}function ln(n,e,t){const r=[];for(const s of e.configuration.sort((o,l)=>l.order-o.order))r.push(...s.exit);for(const s of Object.values(e.children))r.push(Gr(s));return dt(r,n,e,t)}function cn(n,e){return e.machine.getTransitionData(e,n)}function Ji(n,e){const t=new Set,r=n.configuration.filter(ut);for(const s of r)e:for(const o of[s].concat(Ct(s,null)))if(o.always){for(const l of o.always)if(l.guard===void 0||Ft(l.guard,n.context,e,n)){t.add(l);break e}}return Lr(Array.from(t),new Set(n.configuration),n.historyValue)}function un(n,e){const t=Ve(Ue(n,e));return Mr(n,[...t])}function Yi(n){const e=[],t=n.initial,r=new Set;Rr([t],{},new Set([n]),r);for(const o of[...r].sort((l,f)=>l.order-f.order))e.push(o);return e}class ce{static from(e,t={},r){if(e instanceof ce)return e.context!==t?new ce({value:e.value,context:t,meta:{},configuration:[],children:{}},r):e;const s=Ve(Ue(r.root,e));return new ce({value:e,context:t,meta:void 0,configuration:Array.from(s),children:{}},r)}constructor(e,t){this.machine=t,this.tags=void 0,this.value=void 0,this.done=void 0,this.output=void 0,this.context=void 0,this.historyValue={},this._internalQueue=void 0,this.configuration=void 0,this.children=void 0,this.context=e.context,this._internalQueue=e._internalQueue??[],this.historyValue=e.historyValue||{},this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration??Array.from(Ve(Ue(t.root,e.value))),this.children=e.children,this.value=Mr(t.root,this.configuration),this.tags=new Set(It(this.configuration.map(r=>r.tags))),this.done=e.done??!1,this.output=e.output}toStrings(e=this.value){if(typeof e=="string")return[e];const t=Object.keys(e);return t.concat(...t.map(r=>this.toStrings(e[r]).map(s=>r+Le+s)))}toJSON(){const{configuration:e,tags:t,machine:r,...s}=this;return{...s,tags:Array.from(t),meta:this.meta}}matches(e){return Tr(e,this.value)}hasTag(e){return this.tags.has(e)}can(e){const t=this.machine.getTransitionData(this,e);return!!(t!=null&&t.length)&&t.some(r=>r.target!==void 0||r.actions.length)}get nextEvents(){return ge(this,"nextEvents",()=>[...new Set(It([...this.configuration.map(e=>e.ownEvents)]))])}get meta(){return this.configuration.reduce((e,t)=>(t.meta!==void 0&&(e[t.id]=t.meta),e),{})}}function be(n,e={}){return new ce({...n,...e},n.machine)}function Zi(n){var f,u;const{configuration:e,tags:t,machine:r,children:s,...o}=n,l={};for(const d in s)l[d]={state:(u=(f=s[d]).getPersistedState)==null?void 0:u.call(f),src:s[d].src};return{...o,children:l}}function es(n,e,t,{actorRef:r}){const s=typeof r=="function"?r(t):r,o=typeof s=="string"?e.children[s]:s;let l=e.children;return o&&(l={...l},delete l[o.id]),[be(e,{children:l}),o]}function ts(n,e){if(e){if(e.status!==Z.Running){n.stopChild(e);return}n.defer(()=>{n.stopChild(e)})}}function Gr(n){function e(t){}return e.type="xstate.stop",e.actorRef=n,e.resolve=es,e.execute=ts,e}function ns(n,{machine:e,context:t},r,s){const o=(l,f={})=>{const{systemId:u}=f;if(typeof l=="string"){const d=tt(e.implementations.actors[l]);if(!d)throw new Error(`Actor logic '${l}' not implemented in machine '${e.id}'`);const g="input"in f?f.input:d.input,i=Me(d.src,{id:f.id,parent:n.self,input:typeof g=="function"?g({context:t,event:r,self:n.self}):g,systemId:u});return s[i.id]=i,i}else return Me(l,{id:f.id,parent:n.self,input:f.input,systemId:u})};return(l,f)=>{const u=o(l,f);return s[u.id]=u,n.defer(()=>{var d;if(u.status!==Z.Stopped)try{(d=u.start)==null||d.call(u)}catch(g){n.self.send(_t(u.id,g));return}}),u}}function rs(n,e,t,{assignment:r}){if(!e.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");const s={},o={context:e.context,event:t.event,action:t.action,spawn:ns(n,e,t.event,s),self:n==null?void 0:n.self,system:n==null?void 0:n.system};let l={};if(typeof r=="function")l=r(o);else for(const u of Object.keys(r)){const d=r[u];l[u]=typeof d=="function"?d(o):d}const f=Object.assign({},e.context,l);return[be(e,{context:f,children:Object.keys(s).length?{...e.children,...s}:e.children})]}function Hr(n){function e(t){}return e.type="xstate.assign",e.assignment=n,e.resolve=rs,e}function is(n,e,t,{event:r,id:s,delay:o}){const l=e.machine.implementations.delays;if(typeof r=="string")throw new Error(`Only event objects may be used with raise; use raise({ type: "${r}" }) instead`);const f=typeof r=="function"?r(t):r;let u;if(typeof o=="string"){const d=l&&l[o];u=typeof d=="function"?d(t):d}else u=typeof o=="function"?o(t):o;return[typeof u!="number"?be(e,{_internalQueue:e._internalQueue.concat(f)}):e,{event:f,id:s,delay:u}]}function ss(n,e){if(typeof e.delay=="number"){n.self.delaySend(e);return}}function os(n,e){function t(r){}return t.type="xstate.raise",t.event=n,t.id=e==null?void 0:e.id,t.delay=e==null?void 0:e.delay,t.resolve=is,t.execute=ss,t}function as(n,e){const t=e?`#${e}`:"";return`${pe.After}(${n})${t}`}function Pt(n,e){const t=`${pe.DoneState}.${n}`,r={type:t,output:e};return r.toString=()=>t,r}function ls(n,e){const t=`${pe.DoneInvoke}.${n}`,r={type:t,output:e};return r.toString=()=>t,r}function _t(n,e){const t=`${pe.ErrorPlatform}.${n}`,r={type:t,data:e};return r.toString=()=>t,r}function cs(n){return{type:Ar,input:n}}const us={},Be=n=>typeof n=="string"?{type:n}:typeof n=="function"?"resolve"in n?{type:n.type}:{type:n.name}:n;class Nt{constructor(e,t){if(this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=t._parent,this.key=t._key,this.machine=t._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(Le),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?sn(this.config.states,(r,s)=>new Nt(r,{_parent:this,_key:s,_machine:this.machine})):us,this.type==="compound"&&!this.config.initial)throw new Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=this.config.history===!0?"shallow":this.config.history||!1,this.entry=_e(this.config.entry),this.exit=_e(this.config.exit),this.meta=this.config.meta,this.output=this.type==="final"?this.config.output:void 0,this.tags=_e(e.tags)}_initialize(){this.transitions=Ci(this),this.config.always&&(this.always=$e(this.config.always).map(e=>he(this,$r,e))),Object.keys(this.states).forEach(e=>{this.states[e]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(Be),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(e=>`#${e.id}`),source:`#${this.id}`,actions:this.initial.actions.map(Be),eventType:null})}:void 0,history:this.history,states:sn(this.states,e=>e.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(e=>({...e,actions:e.actions.map(Be)})),entry:this.entry.map(Be),exit:this.exit.map(Be),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return ge(this,"invoke",()=>_e(this.config.invoke).map((e,t)=>{const r=Oi(this.id,t),s=Ii(e,r),o=s.id||r,l=s.src,{systemId:f}=s,u=typeof l=="string"||"type"in l?l:o;return!this.machine.implementations.actors[o]&&typeof l!="string"&&!("type"in l)&&(this.machine.implementations.actors={...this.machine.implementations.actors,[o]:l}),{type:"xstate.invoke",...s,src:u,id:o,systemId:f,toJSON(){const{onDone:d,onError:g,...i}=s;return{...i,type:"xstate.invoke",src:u,id:o}}}}))}get on(){return ge(this,"on",()=>[...this.transitions].flatMap(([t,r])=>r.map(s=>[t,s])).reduce((t,[r,s])=>(t[r]=t[r]||[],t[r].push(s),t),{}))}get after(){return ge(this,"delayedTransitions",()=>Fi(this))}get initial(){return ge(this,"initial",()=>Bi(this,this.config.initial||[]))}next(e,t){const r=t.type,s=[];let o;const l=ge(this,`candidates-${r}`,()=>Hi(this,r));for(const f of l){const{guard:u}=f,d=e.context;let g=!1;try{g=!u||Ft(u,d,t,e)}catch(i){throw new Error(`Unable to evaluate guard '${u.type}' in transition for event '${r}' in state node '${this.id}':
${i.message}`)}if(g){s.push(...f.actions),o=f;break}}return o?[o]:void 0}get target(){if(this.type==="history")return this.config.target}get stateIds(){const e=It(Object.keys(this.states).map(t=>this.states[t].stateIds));return[this.id].concat(e)}get events(){return ge(this,"events",()=>{const{states:e}=this,t=new Set(this.ownEvents);if(e)for(const r of Object.keys(e)){const s=e[r];if(s.states)for(const o of s.events)t.add(`${o}`)}return Array.from(t)})}get ownEvents(){const e=new Set([...this.transitions.keys()].filter(t=>this.transitions.get(t).some(r=>!(!r.target&&!r.actions.length&&!r.reenter))));return Array.from(e)}}const fs="#";class Vt{constructor(e,t){this.config=e,this.version=void 0,this.implementations=void 0,this.types=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.__TContext=void 0,this.__TEvent=void 0,this.__TAction=void 0,this.__TActorMap=void 0,this.__TResolvedTypesMeta=void 0,this.id=e.id||"(machine)",this.implementations={actors:(t==null?void 0:t.actors)??{},actions:(t==null?void 0:t.actions)??{},delays:(t==null?void 0:t.delays)??{},guards:(t==null?void 0:t.guards)??{}},this.version=this.config.version,this.types=this.config.types??{},this.transition=this.transition.bind(this),this.root=new Nt(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(e){const{actions:t,guards:r,actors:s,delays:o}=this.implementations;return new Vt(this.config,{actions:{...t,...e.actions},guards:{...r,...e.guards},actors:{...s,...e.actors},delays:{...o,...e.delays}})}resolveState(e){const t=Ve(Ue(this.root,e.value)),r=Array.from(t);return this.createState({...e,value:un(this.root,e.value),configuration:r,done:ft(r)})}resolveStateValue(e,...[t]){const r=un(this.root,e);return this.resolveState(ce.from(r,t,this))}transition(e,t,r){if(ki(t)&&!e.nextEvents.some(o=>o===t.type))throw t.data;const{state:s}=vt(e,t,r);return s}microstep(e,t,r){return vt(e,t,r).microstates}getTransitionData(e,t){return Bt(this.root,e.value,e,t)||[]}getPreInitialState(e,t){const{context:r}=this.config,s=this.resolveState(this.createState({value:{},context:typeof r!="function"&&r?r:{},meta:void 0,configuration:Yi(this.root),children:{}}));return typeof r=="function"?dt([Hr(({spawn:l,event:f})=>r({spawn:l,input:f.input}))],t,s,e):s}getInitialState(e,t){const r=cs(t),s=this.getPreInitialState(e,r),o=Ye([{target:[...s.configuration].filter(ut),source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],s,e,r,!0),{state:l}=vt(o,r,e);return l}start(e,t){Object.values(e.children).forEach(r=>{var s;if(r.status===0)try{(s=r.start)==null||s.call(r)}catch(o){t.self.send(_t(r.id,o))}})}getStateNodeById(e){const t=e.split(Le),r=t.slice(1),s=je(t[0])?t[0].slice(fs.length):t[0],o=this.idMap.get(s);if(!o)throw new Error(`Child state node '#${s}' does not exist on machine '${this.id}'`);return it(o,r)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedState(e){return Zi(e)}createState(e){return e instanceof ce?e:new ce(e,this)}getStatus(e){return e.done?{status:"done",data:e.output}:{status:"active"}}restoreState(e,t){const r={};Object.keys(e.children).forEach(o=>{var a,c;const l=e.children[o],f=l.state,u=l.src,d=u?(a=tt(this.implementations.actors[u]))==null?void 0:a.src:void 0;if(!d)return;const g=(c=d.restoreState)==null?void 0:c.call(d,f,t),i=Me(d,{id:o,state:g});r[o]=i});const s=this.createState(new ce({...e,children:r},this));return s.configuration.forEach(o=>{o.invoke&&o.invoke.forEach(l=>{const{id:f,src:u}=l;if(r[f])return;const d=tt(this.implementations.actors[u]);if(d){const g=Me(d.src,{id:f,parent:t==null?void 0:t.self,input:"input"in l?l.input:d.input});r[f]=g}})}),s}}function ds(n,e){return new Vt(n,e)}function _s(n,...[e={}]){const{guards:t,actions:r,actors:s,delays:o,...l}=e,f={guards:t,actions:r,actors:s,delays:o},u=n.provide(f),d=Me(u,l).start();ni(()=>d.stop());let g=d.getSnapshot();return{state:yr(g,a=>d.subscribe(c=>{g!==c&&(g=c,a(g))}).unsubscribe),send:d.send,service:d}}const Fr={},ps=n=>{ri(Fr,n)},we=()=>ii(Fr),hs=ds({id:"gameClient",context:({input:n})=>n,types:{context:{},events:{},actors:{}},initial:"Lobby",states:{Lobby:{initial:"Assigning sides",states:{"Assigning sides":{description:`This is the first step of the game setup, where users can join and are assigned to be either attacker or defender.

Users can also be made administrators.`,initial:"Incomplete",states:{Incomplete:{always:{target:"Ready",guard:"allSidesAssigned",description:"All users have been assigned a side and there is an admin on both sides",reenter:!1}},Ready:{on:{"next step":{target:"Ready",guard:"isAdmin",actions:{params:{},type:"forwardToServer"},reenter:!1}}}},always:{target:"Assigning roles",guard:"finishedAssigningSides",reenter:!1},on:{"assign side":{target:"Assigning sides",guard:"isAdmin",actions:{params:{},type:"forwardToServer"},reenter:!1},"assign admin":{target:"Assigning sides",guard:"isAdmin",actions:{params:{},type:"forwardToServer"},reenter:!1}}},"Assigning roles":{description:"All users have been assigned a side, and now the roles will be configured.",initial:"Incomplete",states:{Incomplete:{always:[{target:"Ready",guard:"allRolesAssignedOfSide",description:"All users have been assigned a role.",reenter:!1},{target:"Editing player",guard:"isEditingPlayerOfSide",reenter:!1}]},Ready:{always:{target:"Editing player",guard:"isEditingPlayerOfSide",reenter:!1},on:{"next step":{target:"Ready",guard:"isAdmin",actions:{params:{},type:"forwardToServer"},reenter:!1}}},"Editing player":{description:"Shows a modal where the admin can select the user, role and face image",always:{target:"Incomplete",guard:"isNotEditingPlayerOfSide",reenter:!1},on:{"assign role":{target:"Editing player",guard:"isAdmin",actions:{params:{},type:"forwardToServer"},reenter:!1}}}},always:{target:"Waiting for other side",guard:"finishedAssigningRolesOfSide",reenter:!1},on:{"start editing player":{target:"Assigning roles",guard:"isAdmin",actions:{params:{},type:"forwardToServer"},reenter:!1},"stop editing player":{target:"Assigning roles",guard:"isAdmin",actions:{params:{},type:"forwardToServer"},reenter:!1}}},"Waiting for other side":{}},always:{target:"Ingame",guard:"finishedAssigningRoles",reenter:!1}},Ingame:{states:{Gameloop:{initial:"Waiting",states:{Waiting:{always:{target:"Playing",guard:"userOnActiveSide",reenter:!1}},Playing:{initial:"Ready to move",states:{"Ready to move":{always:{target:"Ready for action",guard:"playerMoved",reenter:!1},on:{move:{target:"Ready to move",guard:"userControlsPlayer",actions:{params:{},type:"forwardToServer"},reenter:!1}}},"Ready for action":{always:{target:"Ready to move",guard:"playerPerformedAction",reenter:!1},on:{"perform action":{target:"Ready for action",guard:"userControlsPlayer",actions:{params:{},type:"forwardToServer"},reenter:!1}}}},always:{target:"Waiting",guard:"userNotOnActiveSide",reenter:!1}}}},"Global Attack":{initial:"Showing current global attack",states:{"Showing current global attack":{on:{"dismiss global attack":{target:"Dismissed",reenter:!1}}},Dismissed:{on:{"new global attack":{target:"Showing current global attack",reenter:!1},"show global attack":{target:"Showing current global attack",reenter:!1}}}}},Sides:{initial:"Initial",states:{Initial:{always:[{target:"Defense",guard:"userIsDefender",reenter:!1},{target:"Attack",reenter:!1}]},Defense:{states:{"Attacker visibility":{initial:"Invisible",states:{Invisible:{always:{target:"Visible",guard:"attackerShouldBeVisible",reenter:!1}},Visible:{always:{target:"Invisible",guard:"attackerShouldBeInvisible",reenter:!1}}}}},type:"parallel"},Attack:{}},on:{"switch sides":{target:"Sides",guard:"isAdmin",actions:{params:{},type:"forwardToServer"},reenter:!1}}}},always:{target:"Finished",guard:"gameFinished",reenter:!1},type:"parallel"},Finished:{description:"The game finished, but the users can still communicate by sending emojis."},"Server stopped":{type:"final"}},always:{target:".Server stopped",guard:"isServerStopped",reenter:!1},on:{"shared game context update":{target:"#gameClient",actions:{params:{},type:"updateSharedGameContext"},reenter:!1},"send emoji":{target:"#gameClient",actions:{params:{},type:"forwardToServer"},reenter:!1},"show emoji":{actions:{params:{},type:"showEmoji"},reenter:!0}}}),gs={gameFinished:()=>!1,allSidesAssigned:({context:n})=>n.users.every(e=>e.isSideAssigned)&&!!n.users.find(e=>e.side==="defender"&&e.isAdmin)&&!!n.users.find(e=>e.side==="attacker"&&e.isAdmin),finishedAssigningSides:({context:n})=>n.finishedAssigningSides,allRolesAssigned:({context:n})=>n.attack.attacker.isConfigured&&n.defense.defenders.every(e=>e.isConfigured),finishedAssigningRoles:({context:n})=>n.attack.finishedAssigning&&n.defense.finishedAssigning,attackerShouldBeVisible:()=>!1,attackerShouldBeInvisible:()=>!1},et=n=>{const e=n.users.find(t=>t.id===n.userId);if(!e)throw new Error("The current user was not found in the users list.");return e},ms=({send:n,actions:e})=>hs.provide({actions:{updateSharedGameContext:Hr(({event:t})=>({...t.sharedGameContext})),showEmoji:({event:t})=>{const r=t;e.showEmoji({userId:r.userId,emoji:r.emoji})},forwardToServer:({event:t})=>{const r=t;n({...r,type:`user: ${r.type}`})}},actors:{},guards:{isHost:({context:t})=>t.hostUserId===t.userId,isAdmin:({context:t})=>!!t.users.find(r=>r.id===t.userId&&r.isAdmin),isPlayer:({context:t})=>t.hostUserId!==t.userId,allRolesAssignedOfSide:({context:t})=>{const{side:r}=et(t);return r?r==="attacker"?!!t.attack.attacker:t.defense.defenders.length===4:!1},finishedAssigningRolesOfSide:({context:t})=>{const{side:r}=et(t);return r?(r==="attacker"?t.attack:t.defense).finishedAssigning:!1},isEditingPlayerOfSide:({context:t})=>{const{side:r}=et(t);return r?(r==="attacker"?t.attack:t.defense).editingPlayer!==void 0:!1},isNotEditingPlayerOfSide:Ri("isEditingPlayerOfSide"),userControlsPlayer:()=>!1,userOnActiveSide:()=>!1,userNotOnActiveSide:()=>!1,playerMoved:()=>!1,userIsDefender:()=>!1,isServerStopped:()=>!1,playerPerformedAction:()=>!1,...gs}}),vs=({gameId:n,userId:e,onMessage:t})=>{const r=ui({status:"opening",log:[]}),s=(d,g)=>(console.debug("[websocket]",d,g),r.update(i=>({...i,log:[...i.log,`[websocket] ${d}`]}))),o=d=>r.update(g=>({...g,status:d}));let l;const f=()=>{s("connecting");const d=window.location.protocol==="https:"?"wss:":"ws:";l=new WebSocket(`${d}//${window.location.host}/websocket?gameId=${n}&userId=${e}`),l.addEventListener("open",()=>{o("opened"),s("connection open")}),l.addEventListener("close",()=>{o("closed"),s("connection closed")}),l.addEventListener("message",g=>{try{const i=JSON.parse(g.data);i.type!=="mouse position"&&s(`message received: ${g.data}`,g),t(i)}catch(i){s("error parsing message",i)}})},u=d=>{l==null||l.send(JSON.stringify(d))};return{subscribe:r.subscribe,open:f,close:()=>l==null?void 0:l.close(),send:u}};function ys(n,e){return n===e}const Y=(n,e,t=ys)=>{let r,s=e(n.getSnapshot());return yr(s,l=>{const f=u=>{const d=e(u);t(s,d)||(s=d,l(d))};return f(n.getSnapshot()),r=n.subscribe(f),()=>{r.unsubscribe()}})};var M=class{static clamp(n,e,t){return Math.max(e,typeof t<"u"?Math.min(n,t):n)}static clampV(n,e,t){return n.map(r=>t?M.clamp(r,e,t):M.clamp(r,e))}static cross(n,e,t){return(e[0]-n[0])*(t[1]-n[1])-(t[0]-n[0])*(e[1]-n[1])}static snap(n,e=1){return[Math.round(n[0]/e)*e,Math.round(n[1]/e)*e]}},E=M;E.neg=n=>[-n[0],-n[1]];E.add=(n,e)=>[n[0]+e[0],n[1]+e[1]];E.addScalar=(n,e)=>[n[0]+e,n[1]+e];E.sub=(n,e)=>[n[0]-e[0],n[1]-e[1]];E.subScalar=(n,e)=>[n[0]-e,n[1]-e];E.vec=(n,e)=>[e[0]-n[0],e[1]-n[1]];E.mul=(n,e)=>[n[0]*e,n[1]*e];E.mulV=(n,e)=>[n[0]*e[0],n[1]*e[1]];E.div=(n,e)=>[n[0]/e,n[1]/e];E.divV=(n,e)=>[n[0]/e[0],n[1]/e[1]];E.per=n=>[n[1],-n[0]];E.dpr=(n,e)=>n[0]*e[0]+n[1]*e[1];E.cpr=(n,e)=>n[0]*e[1]-e[0]*n[1];E.len2=n=>n[0]*n[0]+n[1]*n[1];E.len=n=>Math.hypot(n[0],n[1]);E.pry=(n,e)=>M.dpr(n,e)/M.len(e);E.uni=n=>M.div(n,M.len(n));E.normalize=n=>M.uni(n);E.tangent=(n,e)=>M.uni(M.sub(n,e));E.dist2=(n,e)=>M.len2(M.sub(n,e));E.dist=(n,e)=>Math.hypot(n[1]-e[1],n[0]-e[0]);E.fastDist=(n,e)=>{const t=[e[0]-n[0],e[1]-n[1]],r=[Math.abs(t[0]),Math.abs(t[1])];let s=1/Math.max(r[0],r[1]);return s=s*(1.29289-(r[0]+r[1])*s*.29289),[t[0]*s,t[1]*s]};E.ang=(n,e)=>Math.atan2(M.cpr(n,e),M.dpr(n,e));E.angle=(n,e)=>Math.atan2(e[1]-n[1],e[0]-n[0]);E.med=(n,e)=>M.mul(M.add(n,e),.5);E.rot=(n,e=0)=>[n[0]*Math.cos(e)-n[1]*Math.sin(e),n[0]*Math.sin(e)+n[1]*Math.cos(e)];E.rotWith=(n,e,t=0)=>{if(t===0)return n;const r=Math.sin(t),s=Math.cos(t),o=n[0]-e[0],l=n[1]-e[1],f=o*s-l*r,u=o*r+l*s;return[f+e[0],u+e[1]]};E.isEqual=(n,e)=>n[0]===e[0]&&n[1]===e[1];E.lrp=(n,e,t)=>M.add(n,M.mul(M.sub(e,n),t));E.int=(n,e,t,r,s=1)=>{const o=(M.clamp(t,r)-t)/(r-t);return M.add(M.mul(n,1-o),M.mul(e,s))};E.ang3=(n,e,t)=>{const r=M.vec(e,n),s=M.vec(e,t);return M.ang(r,s)};E.abs=n=>[Math.abs(n[0]),Math.abs(n[1])];E.rescale=(n,e)=>{const t=M.len(n);return[e*n[0]/t,e*n[1]/t]};E.isLeft=(n,e,t)=>(e[0]-n[0])*(t[1]-n[1])-(t[0]-n[0])*(e[1]-n[1]);E.clockwise=(n,e,t)=>M.isLeft(n,e,t)>0;E.toFixed=(n,e=2)=>n.map(t=>+t.toFixed(e));E.nearestPointOnLineThroughPoint=(n,e,t)=>M.add(n,M.mul(e,M.pry(M.sub(t,n),e)));E.distanceToLineThroughPoint=(n,e,t)=>M.dist(t,M.nearestPointOnLineThroughPoint(n,e,t));E.nearestPointOnLineSegment=(n,e,t,r=!0)=>{const s=M.uni(M.sub(e,n)),o=M.add(n,M.mul(s,M.pry(M.sub(t,n),s)));if(r){if(o[0]<Math.min(n[0],e[0]))return n[0]<e[0]?n:e;if(o[0]>Math.max(n[0],e[0]))return n[0]>e[0]?n:e;if(o[1]<Math.min(n[1],e[1]))return n[1]<e[1]?n:e;if(o[1]>Math.max(n[1],e[1]))return n[1]>e[1]?n:e}return o};E.distanceToLineSegment=(n,e,t,r=!0)=>M.dist(t,M.nearestPointOnLineSegment(n,e,t,r));E.nudge=(n,e,t)=>M.isEqual(n,e)?n:M.add(n,M.mul(M.uni(M.sub(e,n)),t));E.nudgeAtAngle=(n,e,t)=>[Math.cos(e)*t+n[0],Math.sin(e)*t+n[1]];E.toPrecision=(n,e=4)=>[+n[0].toPrecision(e),+n[1].toPrecision(e)];E.pointsBetween=(n,e,t=6)=>Array.from(Array(t)).map((r,s)=>{const o=s/(t-1),l=Math.min(1,.5+Math.abs(.5-o));return[...M.lrp(n,e,o),l]});E.slope=(n,e)=>n[0]===e[0]?NaN:(n[1]-e[1])/(n[0]-e[0]);E.max=(...n)=>[Math.max(...n.map(e=>e[0])),Math.max(...n.map(e=>e[1]))];E.min=(...n)=>[Math.max(...n.map(e=>e[0])),Math.max(...n.map(e=>e[1]))];var bs=class{constructor(n=[]){this.points=[],this.lengths=[],this.totalLength=0,this.addPoint=e=>{if(this.prev){const t=E.dist(this.prev,e);this.lengths.push(t),this.totalLength+=t,this.points.push(e)}this.prev=e},this.clear=()=>{this.points=this.prev?[this.prev]:[],this.totalLength=0},this.getSplinePoint=e=>{const{points:t}=this,r=t.length-1,s=Math.trunc(e),o=Math.min(s+1,r),l=Math.min(o+1,r),f=Math.min(l+1,r),u=o-1,d=e-s,g=d*d,i=g*d,a=-i+2*g-d,c=3*i-5*g+2,_=-3*i+4*g+d,p=i-g;return[(t[u][0]*a+t[o][0]*c+t[l][0]*_+t[f][0]*p)/2,(t[u][1]*a+t[o][1]*c+t[l][1]*_+t[f][1]*p)/2]},this.points=n,this.lengths=n.map((e,t,r)=>t===0?0:E.dist(e,r[t-1])),this.totalLength=this.lengths.reduce((e,t)=>e+t,0)}},Mt=class{constructor(n){this.state="idle",this.queue=[],this.timestamp=performance.now(),this.lastRequestId=0,this.timeoutId=0,this.spline=new bs,this.addPoint=e=>{clearTimeout(this.timeoutId);const t=performance.now(),r=Math.min(t-this.timestamp,Mt.MAX_INTERVAL);if(!this.prevPoint){this.spline.clear(),this.prevPoint=e,this.spline.addPoint(e),this.cb(e),this.state="stopped";return}if(this.state==="stopped"){if(E.dist(this.prevPoint,e)<4){this.cb(e);return}this.spline.clear(),this.spline.addPoint(this.prevPoint),this.spline.addPoint(this.prevPoint),this.spline.addPoint(e),this.state="idle"}else this.spline.addPoint(e);if(r<16){this.prevPoint=e,this.timestamp=t,this.cb(e);return}const s={start:this.spline.points.length-3,from:this.prevPoint,to:e,duration:r};switch(this.prevPoint=e,this.timestamp=t,this.state){case"idle":{this.state="animating",this.animateNext(s);break}case"animating":{this.queue.push(s);break}}},this.animateNext=e=>{const t=performance.now(),r=()=>{const s=(performance.now()-t)/e.duration;if(s<=1&&this.spline.points.length>0){try{this.cb(this.spline.getSplinePoint(s+e.start))}catch(l){console.warn(l)}this.lastRequestId=requestAnimationFrame(r);return}const o=this.queue.shift();o?(this.state="animating",this.animateNext(o)):(this.state="idle",this.timeoutId=setTimeout(()=>{this.state="stopped"},Mt.MAX_INTERVAL))};r()},this.dispose=()=>{clearTimeout(this.timeoutId)},this.cb=n}},Cr=Mt;Cr.MAX_INTERVAL=300;function ws(n){let e,t,r,s,o,l=n[0].name+"",f;return{c(){e=L("div"),t=Jt("svg"),r=Jt("path"),s=F(),o=L("span"),f=R(l),this.h()},l(u){e=x(u,"DIV",{class:!0});var d=H(e);t=Yt(d,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,stroke:!0,fill:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0});var g=H(t);r=Yt(g,"path",{d:!0}),H(r).forEach($),g.forEach($),s=C(d),o=x(d,"SPAN",{class:!0});var i=H(o);f=G(i,l),i.forEach($),d.forEach($),this.h()},h(){j(r,"d","M7.904 17.563a1.2 1.2 0 0 0 2.228 .308l2.09 -3.093l4.907 4.907a1.067 1.067 0 0 0 1.509 0l1.047 -1.047a1.067 1.067 0 0 0 0 -1.509l-4.907 -4.907l3.113 -2.09a1.2 1.2 0 0 0 -.309 -2.228l-13.582 -3.904l3.904 13.563z"),j(t,"xmlns","http://www.w3.org/2000/svg"),j(t,"width","44"),j(t,"height","44"),j(t,"viewBox","0 0 24 24"),j(t,"stroke-width","1.5"),j(t,"stroke","#2c3e50"),j(t,"fill","white"),j(t,"stroke-linecap","round"),j(t,"stroke-linejoin","round"),j(t,"class","svelte-jg3id1"),j(o,"class","name svelte-jg3id1"),j(e,"class","cursor svelte-jg3id1")},m(u,d){S(u,e,d),P(e,t),P(t,r),P(e,s),P(e,o),P(o,f),n[3](e)},p(u,[d]){d&1&&l!==(l=u[0].name+"")&&oe(f,l)},i:se,o:se,d(u){u&&$(e),n[3](null)}}}function $s(n,e,t){let{position:r}=e,s,o;mr(()=>(t(2,s=new Cr(([f,u])=>{o.style.setProperty("translate",`${f}px ${u}px`)})),()=>{s==null||s.dispose()}));function l(f){Gt[f?"unshift":"push"](()=>{o=f,t(1,o)})}return n.$$set=f=>{"position"in f&&t(0,r=f.position)},n.$$.update=()=>{n.$$.dirty&5&&(s==null||s.addPoint(r.position))},[r,o,s,l]}class As extends ae{constructor(e){super(),le(this,e,$s,ws,ie,{position:0})}}function fn(n,e,t){const r=n.slice();return r[9]=e[t],r}function dn(n,e){let t,r,s;return r=new As({props:{position:e[9]}}),{key:n,first:null,c(){t=ue(),V(r.$$.fragment),this.h()},l(o){t=ue(),U(r.$$.fragment,o),this.h()},h(){this.first=t},m(o,l){S(o,t,l),W(r,o,l),s=!0},p(o,l){e=o;const f={};l&4&&(f.position=e[9]),r.$set(f)},i(o){s||(T(r.$$.fragment,o),s=!0)},o(o){k(r.$$.fragment,o),s=!1},d(o){o&&$(t),X(r,o)}}}function Ts(n){let e,t=[],r=new Map,s,o,l=te(n[2]);const f=u=>u[9].id;for(let u=0;u<l.length;u+=1){let d=fn(n,l,u),g=f(d);r.set(g,t[u]=dn(g,d))}return{c(){e=L("div");for(let u=0;u<t.length;u+=1)t[u].c();this.h()},l(u){e=x(u,"DIV",{class:!0});var d=H(e);for(let g=0;g<t.length;g+=1)t[g].l(d);d.forEach($),this.h()},h(){j(e,"class","cursor-overlays svelte-1n4ax7h"),Ht(()=>n[6].call(e))},m(u,d){S(u,e,d);for(let g=0;g<t.length;g+=1)t[g]&&t[g].m(e,null);s=vr(e,n[6].bind(e)),o=!0},p(u,[d]){d&4&&(l=te(u[2]),ne(),t=wr(t,d,f,1,u,l,r,e,br,dn,null,fn),re())},i(u){if(!o){for(let d=0;d<l.length;d+=1)T(t[d]);o=!0}},o(u){for(let d=0;d<t.length;d+=1)k(t[d]);o=!1},d(u){u&&$(e);for(let d=0;d<t.length;d+=1)t[d].d();s()}}}function Ss(n,e,t){let r,s,{mousePositions:o={}}=e;const l=we();let f=1,u=1;const d=Y(l.machine.service,a=>a.context.users);K(n,d,a=>t(5,s=a));const g=(a,c)=>a.filter(_=>_.isConnected&&!!c[_.id]).map(_=>{const p=c[_.id];return{id:_.id,name:_.name,position:[p[0]*f,p[1]*u]}});function i(){f=this.clientWidth,u=this.clientHeight,t(0,f),t(1,u)}return n.$$set=a=>{"mousePositions"in a&&t(4,o=a.mousePositions)},n.$$.update=()=>{n.$$.dirty&48&&t(2,r=g(s,o))},[f,u,r,d,o,s,i]}class ks extends ae{constructor(e){super(),le(this,e,Ss,Ts,ie,{mousePositions:4})}}function Is(n){const e=n-1;return e*e*e+1}function Es(n,{delay:e=0,duration:t=400,easing:r=si}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:o=>`opacity: ${o*s}`}}function Os(n,{delay:e=0,duration:t=400,easing:r=Is,start:s=0,opacity:o=0}={}){const l=getComputedStyle(n),f=+l.opacity,u=l.transform==="none"?"":l.transform,d=1-s,g=f*(1-o);return{delay:e,duration:t,easing:r,css:(i,a)=>`
			transform: ${u} scale(${1-d*a});
			opacity: ${f-g*a}
		`}}function _n(n,e,t){const r=n.slice();return r[10]=e[t],r}function pn(n,e,t){const r=n.slice();return r[1]=e[t][0],r[10]=e[t][1],r}function hn(n,e){let t,r,s=e[10].emoji+"",o,l,f,u=e[10].userName+"",d,g,i,a,c,_;function p(){return e[6](e[1])}return{key:n,first:null,c(){t=L("div"),r=L("span"),o=R(s),l=F(),f=L("span"),d=R(u),this.h()},l(m){t=x(m,"DIV",{class:!0});var h=H(t);r=x(h,"SPAN",{class:!0});var y=H(r);o=G(y,s),y.forEach($),l=C(h),f=x(h,"SPAN",{class:!0});var b=H(f);d=G(b,u),b.forEach($),h.forEach($),this.h()},h(){j(r,"class","emjoi"),j(f,"class","name svelte-15c2n3p"),j(t,"class","displayed-emoji svelte-15c2n3p"),Qe(t,"--_x",e[10].position[0]),Qe(t,"--_y",e[10].position[1]),this.first=t},m(m,h){S(m,t,h),P(t,r),P(r,o),P(t,l),P(t,f),P(f,d),a=!0,c||(_=Oe(t,"introend",p),c=!0)},p(m,h){e=m,(!a||h&1)&&s!==(s=e[10].emoji+"")&&oe(o,s),(!a||h&1)&&u!==(u=e[10].userName+"")&&oe(d,u),h&1&&Qe(t,"--_x",e[10].position[0]),h&1&&Qe(t,"--_y",e[10].position[1])},i(m){a||(m&&Ht(()=>{a&&(i&&i.end(1),g=li(t,Os,{duration:200,start:.4}),g.start())}),a=!0)},o(m){g&&g.invalidate(),m&&(i=ci(t,Es,{})),a=!1},d(m){m&&$(t),m&&i&&i.end(),c=!1,_()}}}function gn(n){let e,t=n[10]+"",r,s,o;function l(){return n[7](n[10])}return{c(){e=L("button"),r=R(t),this.h()},l(f){e=x(f,"BUTTON",{class:!0});var u=H(e);r=G(u,t),u.forEach($),this.h()},h(){j(e,"class","emoji svelte-15c2n3p")},m(f,u){S(f,e,u),P(e,r),s||(o=Oe(e,"click",l),s=!0)},p(f,u){n=f},d(f){f&&$(e),s=!1,o()}}}function Ps(n){let e,t=[],r=new Map,s,o,l=te(Object.entries(n[0]));const f=g=>g[1];for(let g=0;g<l.length;g+=1){let i=pn(n,l,g),a=f(i);r.set(a,t[g]=hn(a,i))}let u=te(n[3]),d=[];for(let g=0;g<u.length;g+=1)d[g]=gn(_n(n,u,g));return{c(){e=L("div");for(let g=0;g<t.length;g+=1)t[g].c();s=F();for(let g=0;g<d.length;g+=1)d[g].c();this.h()},l(g){e=x(g,"DIV",{class:!0});var i=H(e);for(let a=0;a<t.length;a+=1)t[a].l(i);s=C(i);for(let a=0;a<d.length;a+=1)d[a].l(i);i.forEach($),this.h()},h(){j(e,"class","emojis svelte-15c2n3p")},m(g,i){S(g,e,i);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null);P(e,s);for(let a=0;a<d.length;a+=1)d[a]&&d[a].m(e,null);o=!0},p(g,[i]){if(i&1&&(l=te(Object.entries(g[0])),ne(),t=wr(t,i,f,1,g,l,r,e,br,hn,s,pn),re()),i&24){u=te(g[3]);let a;for(a=0;a<u.length;a+=1){const c=_n(g,u,a);d[a]?d[a].p(c,i):(d[a]=gn(c),d[a].c(),d[a].m(e,null))}for(;a<d.length;a+=1)d[a].d(1);d.length=u.length}},i(g){if(!o){for(let i=0;i<l.length;i+=1)T(t[i]);o=!0}},o(g){for(let i=0;i<t.length;i+=1)k(t[i]);o=!1},d(g){g&&$(e);for(let i=0;i<t.length;i+=1)t[i].d();Ne(d,g)}}}function Ms(n,e,t){let r;const s=we(),o=Y(s.machine.service,c=>c.context.users);K(n,o,c=>t(8,r=c));const l=["","","","","",""],f=c=>{s.machine.send({type:"send emoji",emoji:c}),g({userId:s.userId,emoji:c})};let u={},d=0;const g=({userId:c,emoji:_})=>{var m;const p=((m=r.find(h=>h.id===c))==null?void 0:m.name)??"Unknown";t(0,u[`${t(1,d++,d)}`]={emoji:_,userName:p,position:[Math.random(),Math.random()]},u),t(0,u),t(1,d++,d)};return[u,d,o,l,f,g,c=>{setTimeout(()=>{delete u[c],t(0,u)},2e3)},c=>f(c)]}class js extends ae{constructor(e){super(),le(this,e,Ms,Ps,ie,{showEmoji:5})}get showEmoji(){return this.$$.ctx[5]}}const Ds=n=>({}),mn=n=>({});function yt(n){let e,t;const r=n[7].default,s=Se(r,n,n[6],null);let o=[{id:n[2]},{class:"h svelte-eb948l"}],l={};for(let f=0;f<o.length;f+=1)l=ai(l,o[f]);return{c(){e=L(n[0]),s&&s.c(),this.h()},l(f){e=x(f,(n[0]||"null").toUpperCase(),{id:!0,class:!0});var u=H(e);s&&s.l(u),u.forEach($),this.h()},h(){Zt(n[0])(e,l)},m(f,u){S(f,e,u),s&&s.m(e,null),t=!0},p(f,u){s&&s.p&&(!t||u&64)&&ke(s,r,f,f[6],t?Ee(r,f[6],u,null):Ie(f[6]),null),Zt(f[0])(e,l=fi(o,[(!t||u&4)&&{id:f[2]},{class:"h svelte-eb948l"}]))},i(f){t||(T(s,f),t=!0)},o(f){k(s,f),t=!1},d(f){f&&$(e),s&&s.d(f)}}}function vn(n){let e,t;const r=n[7].info,s=Se(r,n,n[6],mn);return{c(){e=L("div"),s&&s.c(),this.h()},l(o){e=x(o,"DIV",{class:!0});var l=H(e);s&&s.l(l),l.forEach($),this.h()},h(){j(e,"class","info svelte-eb948l")},m(o,l){S(o,e,l),s&&s.m(e,null),t=!0},p(o,l){s&&s.p&&(!t||l&64)&&ke(s,r,o,o[6],t?Ee(r,o[6],l,Ds):Ie(o[6]),mn)},i(o){t||(T(s,o),t=!0)},o(o){k(s,o),t=!1},d(o){o&&$(e),s&&s.d(o)}}}function Ls(n){let e,t=n[0],r,s,o,l=n[0]&&yt(n),f=n[5].info&&vn(n);return{c(){e=L("div"),l&&l.c(),r=F(),f&&f.c(),this.h()},l(u){e=x(u,"DIV",{class:!0});var d=H(e);l&&l.l(d),r=C(d),f&&f.l(d),d.forEach($),this.h()},h(){j(e,"class",s="heading size-"+n[1]+" svelte-eb948l"),Ae(e,"separator",n[3]),Ae(e,"centered",n[4])},m(u,d){S(u,e,d),l&&l.m(e,null),P(e,r),f&&f.m(e,null),o=!0},p(u,[d]){u[0]?t?ie(t,u[0])?(l.d(1),l=yt(u),t=u[0],l.c(),l.m(e,r)):l.p(u,d):(l=yt(u),t=u[0],l.c(),l.m(e,r)):t&&(l.d(1),l=null,t=u[0]),u[5].info?f?(f.p(u,d),d&32&&T(f,1)):(f=vn(u),f.c(),T(f,1),f.m(e,null)):f&&(ne(),k(f,1,1,()=>{f=null}),re()),(!o||d&2&&s!==(s="heading size-"+u[1]+" svelte-eb948l"))&&j(e,"class",s),(!o||d&10)&&Ae(e,"separator",u[3]),(!o||d&18)&&Ae(e,"centered",u[4])},i(u){o||(T(l,u),T(f),o=!0)},o(u){k(l,u),k(f),o=!1},d(u){u&&$(e),l&&l.d(u),f&&f.d()}}}function xs(n,e,t){let{$$slots:r={},$$scope:s}=e;const o=oi(r);let{size:l="md"}=e,{id:f=void 0}=e,{separator:u=!1}=e,{centered:d=!1}=e,{tag:g=void 0}=e;return g||(g={xl:"h1",lg:"h2",md:"h3",sm:"h4"}[l]),n.$$set=a=>{"size"in a&&t(1,l=a.size),"id"in a&&t(2,f=a.id),"separator"in a&&t(3,u=a.separator),"centered"in a&&t(4,d=a.centered),"tag"in a&&t(0,g=a.tag),"$$scope"in a&&t(6,s=a.$$scope)},[g,l,f,u,d,o,s,r]}class st extends ae{constructor(e){super(),le(this,e,xs,Ls,ie,{size:1,id:2,separator:3,centered:4,tag:0})}}function yn(n,e,t){const r=n.slice();return r[16]=e[t],r}function Rs(n){let e;return{c(){e=R("Einteilung in Teams")},l(t){e=G(t,"Einteilung in Teams")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function Gs(n){let e;return{c(){e=R("Schritt 2 von 3")},l(t){e=G(t,"Schritt 2 von 3")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function bn(n){let e,t="(admin)";return{c(){e=L("span"),e.textContent=t,this.h()},l(r){e=x(r,"SPAN",{class:!0,"data-svelte-h":!0}),ct(e)!=="svelte-16777ag"&&(e.textContent=t),this.h()},h(){j(e,"class","admin")},m(r,s){S(r,e,s)},d(r){r&&$(e)}}}function wn(n){let e;function t(o,l){return o[16].side==="attacker"?Fs:Hs}let r=t(n),s=r(n);return{c(){e=L("span"),s.c(),this.h()},l(o){e=x(o,"SPAN",{class:!0});var l=H(e);s.l(l),l.forEach($),this.h()},h(){j(e,"class","side svelte-1w8krv2")},m(o,l){S(o,e,l),s.m(e,null)},p(o,l){r!==(r=t(o))&&(s.d(1),s=r(o),s&&(s.c(),s.m(e,null)))},d(o){o&&$(e),s.d()}}}function Hs(n){let e;return{c(){e=R("Verteidigung")},l(t){e=G(t,"Verteidigung")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function Fs(n){let e;return{c(){e=R("Angriff")},l(t){e=G(t,"Angriff")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function $n(n){let e,t,r,s;function o(){return n[12](n[16])}e=new Pe({props:{$$slots:{default:[Cs]},$$scope:{ctx:n}}}),e.$on("click",o);function l(){return n[13](n[16])}return r=new Pe({props:{$$slots:{default:[Bs]},$$scope:{ctx:n}}}),r.$on("click",l),{c(){V(e.$$.fragment),t=F(),V(r.$$.fragment)},l(f){U(e.$$.fragment,f),t=C(f),U(r.$$.fragment,f)},m(f,u){W(e,f,u),S(f,t,u),W(r,f,u),s=!0},p(f,u){n=f;const d={};u&524288&&(d.$$scope={dirty:u,ctx:n}),e.$set(d);const g={};u&524288&&(g.$$scope={dirty:u,ctx:n}),r.$set(g)},i(f){s||(T(e.$$.fragment,f),T(r.$$.fragment,f),s=!0)},o(f){k(e.$$.fragment,f),k(r.$$.fragment,f),s=!1},d(f){f&&$(t),X(e,f),X(r,f)}}}function Cs(n){let e;return{c(){e=R("Angriff")},l(t){e=G(t,"Angriff")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function Bs(n){let e;return{c(){e=R("Verteidigung")},l(t){e=G(t,"Verteidigung")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function An(n){let e,t;function r(){return n[14](n[16])}return e=new Pe({props:{$$slots:{default:[qs]},$$scope:{ctx:n}}}),e.$on("click",r),{c(){V(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,o){W(e,s,o),t=!0},p(s,o){n=s;const l={};o&524288&&(l.$$scope={dirty:o,ctx:n}),e.$set(l)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){k(e.$$.fragment,s),t=!1},d(s){X(e,s)}}}function qs(n){let e;return{c(){e=R("Toggle Admin")},l(t){e=G(t,"Toggle Admin")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function Tn(n){let e,t=n[16].name+"",r,s,o,l,f,u,d,g=n[16].isAdmin&&bn(),i=n[16].isSideAssigned&&wn(n),a=n[1]&&$n(n),c=n[2]&&n[16].id!==n[4]&&An(n);return{c(){e=L("div"),r=R(t),s=F(),g&&g.c(),o=F(),i&&i.c(),l=F(),a&&a.c(),f=F(),c&&c.c(),u=F(),this.h()},l(_){e=x(_,"DIV",{class:!0});var p=H(e);r=G(p,t),s=C(p),g&&g.l(p),o=C(p),i&&i.l(p),l=C(p),a&&a.l(p),f=C(p),c&&c.l(p),u=C(p),p.forEach($),this.h()},h(){j(e,"class","user")},m(_,p){S(_,e,p),P(e,r),P(e,s),g&&g.m(e,null),P(e,o),i&&i.m(e,null),P(e,l),a&&a.m(e,null),P(e,f),c&&c.m(e,null),P(e,u),d=!0},p(_,p){(!d||p&1)&&t!==(t=_[16].name+"")&&oe(r,t),_[16].isAdmin?g||(g=bn(),g.c(),g.m(e,o)):g&&(g.d(1),g=null),_[16].isSideAssigned?i?i.p(_,p):(i=wn(_),i.c(),i.m(e,l)):i&&(i.d(1),i=null),_[1]?a?(a.p(_,p),p&2&&T(a,1)):(a=$n(_),a.c(),T(a,1),a.m(e,f)):a&&(ne(),k(a,1,1,()=>{a=null}),re()),_[2]&&_[16].id!==_[4]?c?(c.p(_,p),p&5&&T(c,1)):(c=An(_),c.c(),T(c,1),c.m(e,u)):c&&(ne(),k(c,1,1,()=>{c=null}),re())},i(_){d||(T(a),T(c),d=!0)},o(_){k(a),k(c),d=!1},d(_){_&&$(e),g&&g.d(),i&&i.d(),a&&a.d(),c&&c.d()}}}function Sn(n){let e,t;return e=new Pe({props:{$$slots:{default:[Ns]},$$scope:{ctx:n}}}),e.$on("click",n[15]),{c(){V(e.$$.fragment)},l(r){U(e.$$.fragment,r)},m(r,s){W(e,r,s),t=!0},p(r,s){const o={};s&524288&&(o.$$scope={dirty:s,ctx:r}),e.$set(o)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){X(e,r)}}}function Ns(n){let e;return{c(){e=R("Next")},l(t){e=G(t,"Next")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function Vs(n){let e,t,r,s=`Gleich gehts los. Sobald alle Teilnehmende sich eingeloggt haben, kann die Spielleitung alle in
  Teams einteilen.`,o,l,f,u,d;e=new st({props:{separator:!0,$$slots:{info:[Gs],default:[Rs]},$$scope:{ctx:n}}});let g=te(n[0]),i=[];for(let _=0;_<g.length;_+=1)i[_]=Tn(yn(n,g,_));const a=_=>k(i[_],1,1,()=>{i[_]=null});let c=n[3]&&Sn(n);return{c(){V(e.$$.fragment),t=F(),r=L("p"),r.textContent=s,o=F(),l=L("div");for(let _=0;_<i.length;_+=1)i[_].c();f=F(),c&&c.c(),u=ue(),this.h()},l(_){U(e.$$.fragment,_),t=C(_),r=x(_,"P",{"data-svelte-h":!0}),ct(r)!=="svelte-ugtca6"&&(r.textContent=s),o=C(_),l=x(_,"DIV",{class:!0});var p=H(l);for(let m=0;m<i.length;m+=1)i[m].l(p);p.forEach($),f=C(_),c&&c.l(_),u=ue(),this.h()},h(){j(l,"class","users svelte-1w8krv2")},m(_,p){W(e,_,p),S(_,t,p),S(_,r,p),S(_,o,p),S(_,l,p);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(l,null);S(_,f,p),c&&c.m(_,p),S(_,u,p),d=!0},p(_,[p]){const m={};if(p&524288&&(m.$$scope={dirty:p,ctx:_}),e.$set(m),p&3095){g=te(_[0]);let h;for(h=0;h<g.length;h+=1){const y=yn(_,g,h);i[h]?(i[h].p(y,p),T(i[h],1)):(i[h]=Tn(y),i[h].c(),T(i[h],1),i[h].m(l,null))}for(ne(),h=g.length;h<i.length;h+=1)a(h);re()}_[3]?c?(c.p(_,p),p&8&&T(c,1)):(c=Sn(_),c.c(),T(c,1),c.m(u.parentNode,u)):c&&(ne(),k(c,1,1,()=>{c=null}),re())},i(_){if(!d){T(e.$$.fragment,_);for(let p=0;p<g.length;p+=1)T(i[p]);T(c),d=!0}},o(_){k(e.$$.fragment,_),i=i.filter(Boolean);for(let p=0;p<i.length;p+=1)k(i[p]);k(c),d=!1},d(_){_&&($(t),$(r),$(o),$(l),$(f),$(u)),X(e,_),Ne(i,_),c&&c.d(_)}}}function Us(n,e,t){let r,s,o,l;const{userId:f,machine:u}=we(),d=Y(u.service,b=>b.can({type:"assign side",otherUserId:"",side:"attacker"}));K(n,d,b=>t(1,s=b));const g=Y(u.service,b=>b.can({type:"assign admin",otherUserId:"",isAdmin:!0}));K(n,g,b=>t(2,o=b));const i=Y(u.service,b=>b.can({type:"next step"}));K(n,i,b=>t(3,l=b));const a=Y(u.service,b=>b.context.users);K(n,a,b=>t(0,r=b));const c=(b,v)=>{u.send({type:"assign side",otherUserId:b,side:v})},_=(b,v)=>{u.send({type:"assign admin",otherUserId:b,isAdmin:v})};return[r,s,o,l,f,u,d,g,i,a,c,_,b=>c(b.id,"attacker"),b=>c(b.id,"defender"),b=>_(b.id,!b.isAdmin),()=>u.send({type:"next step"})]}class Ws extends ae{constructor(e){super(),le(this,e,Us,Vs,ie,{})}}function Xs(n){let e,t,r;const s=n[2].default,o=Se(s,n,n[1],null);return{c(){e=L("p"),o&&o.c(),this.h()},l(l){e=x(l,"P",{class:!0});var f=H(e);o&&o.l(f),f.forEach($),this.h()},h(){j(e,"class",t="size-"+n[0]+" svelte-de2sr5")},m(l,f){S(l,e,f),o&&o.m(e,null),r=!0},p(l,[f]){o&&o.p&&(!r||f&2)&&ke(o,s,l,l[1],r?Ee(s,l[1],f,null):Ie(l[1]),null),(!r||f&1&&t!==(t="size-"+l[0]+" svelte-de2sr5"))&&j(e,"class",t)},i(l){r||(T(o,l),r=!0)},o(l){k(o,l),r=!1},d(l){l&&$(e),o&&o.d(l)}}}function zs(n,e,t){let{$$slots:r={},$$scope:s}=e,{size:o="md"}=e;return n.$$set=l=>{"size"in l&&t(0,o=l.size),"$$scope"in l&&t(1,s=l.$$scope)},[o,s,r]}class kn extends ae{constructor(e){super(),le(this,e,zs,Xs,ie,{size:0})}}const In={man:"man",woman:"woman",other:"other"},Ks=n=>n!=="attacker";function En(n,e,t){const r=n.slice();return r[18]=e[t][0],r[19]=e[t][1],r}function On(n,e,t){const r=n.slice();return r[22]=e[t],r}function Pn(n){let e,t=n[22].name+"",r,s;return{c(){e=L("option"),r=R(t),this.h()},l(o){e=x(o,"OPTION",{});var l=H(e);r=G(l,t),l.forEach($),this.h()},h(){e.__value=s=n[22].id,St(e,e.__value)},m(o,l){S(o,e,l),P(e,r)},p(o,l){l&8&&t!==(t=o[22].name+"")&&oe(r,t),l&8&&s!==(s=o[22].id)&&(e.__value=s,St(e,e.__value))},d(o){o&&$(e)}}}function Mn(n){let e,t=n[19]+"",r,s,o,l;function f(){return n[14](n[18])}return{c(){e=L("button"),r=R(t),this.h()},l(u){e=x(u,"BUTTON",{class:!0});var d=H(e);r=G(d,t),d.forEach($),this.h()},h(){e.disabled=s=!n[2],j(e,"class","face svelte-u0xhbm"),Ae(e,"active",n[18]===n[1])},m(u,d){S(u,e,d),P(e,r),o||(l=Oe(e,"click",f),o=!0)},p(u,d){n=u,d&4&&s!==(s=!n[2])&&(e.disabled=s),d&2&&Ae(e,"active",n[18]===n[1])},d(u){u&&$(e),o=!1,l()}}}function Qs(n){let e,t,r,s="--PLEASE SELECT--",o,l,f,u,d,g,i,a,c,_=te(n[3]),p=[];for(let y=0;y<_.length;y+=1)p[y]=Pn(On(n,_,y));let m=te(Object.entries(In)),h=[];for(let y=0;y<m.length;y+=1)h[y]=Mn(En(n,m,y));return{c(){e=L("div"),t=L("select"),r=L("option"),r.textContent=s;for(let y=0;y<p.length;y+=1)p[y].c();l=F(),f=L("div");for(let y=0;y<h.length;y+=1)h[y].c();u=F(),d=L("button"),g=R("Close"),this.h()},l(y){e=x(y,"DIV",{class:!0});var b=H(e);t=x(b,"SELECT",{});var v=H(t);r=x(v,"OPTION",{"data-svelte-h":!0}),ct(r)!=="svelte-108q7wa"&&(r.textContent=s);for(let A=0;A<p.length;A+=1)p[A].l(v);v.forEach($),l=C(b),f=x(b,"DIV",{class:!0});var w=H(f);for(let A=0;A<h.length;A+=1)h[A].l(w);w.forEach($),u=C(b),d=x(b,"BUTTON",{});var I=H(d);g=G(I,"Close"),I.forEach($),b.forEach($),this.h()},h(){r.__value="",St(r,r.__value),t.disabled=o=!n[2],j(f,"class","faces svelte-u0xhbm"),d.disabled=i=!n[2],j(e,"class","configurator svelte-u0xhbm")},m(y,b){S(y,e,b),P(e,t),P(t,r);for(let v=0;v<p.length;v+=1)p[v]&&p[v].m(t,null);en(t,n[0]),P(e,l),P(e,f);for(let v=0;v<h.length;v+=1)h[v]&&h[v].m(f,null);P(e,u),P(e,d),P(d,g),a||(c=[Oe(t,"input",n[13]),Oe(d,"click",n[15])],a=!0)},p(y,[b]){if(b&8){_=te(y[3]);let v;for(v=0;v<_.length;v+=1){const w=On(y,_,v);p[v]?p[v].p(w,b):(p[v]=Pn(w),p[v].c(),p[v].m(t,null))}for(;v<p.length;v+=1)p[v].d(1);p.length=_.length}if(b&4&&o!==(o=!y[2])&&(t.disabled=o),b&9&&en(t,y[0]),b&518){m=te(Object.entries(In));let v;for(v=0;v<m.length;v+=1){const w=En(y,m,v);h[v]?h[v].p(w,b):(h[v]=Mn(w),h[v].c(),h[v].m(f,null))}for(;v<h.length;v+=1)h[v].d(1);h.length=m.length}b&4&&i!==(i=!y[2])&&(d.disabled=i)},i:se,o:se,d(y){y&&$(e),Ne(p,y),Ne(h,y),a=!1,gr(c)}}}function Js(n,e,t){let r,s,o,l,f,u,{playerId:d}=e;const g=Ks(d)?"defender":"attacker",{machine:i}=we(),a=Y(i.service,({context:w})=>g==="attacker"?w.attack.attacker:w.defense.defenders[d]);K(n,a,w=>t(12,l=w));const c=Y(i.service,({context:w})=>w.users.filter(I=>I.side===g));K(n,c,w=>t(3,u=w));const _=Y(i.service,w=>w.can({type:"assign role",role:o,playerId:d,playingUserId:r,face:s}));K(n,_,w=>t(2,f=w));const p=()=>{i.send({type:"assign role",role:o,playerId:d,playingUserId:r,face:s})},m=w=>{t(1,s=w),p()},h=w=>{w&&(t(0,r=w),p())},y=w=>h(w.currentTarget.value),b=w=>m(w),v=()=>i.send({type:"stop editing player",side:g});return n.$$set=w=>{"playerId"in w&&t(11,d=w.playerId)},n.$$.update=()=>{n.$$.dirty&4096&&t(0,r=l.userId),n.$$.dirty&4096&&t(1,s=l.face),n.$$.dirty&4096&&(o=l.role)},[r,s,f,u,g,i,a,c,_,m,h,d,l,y,b,v]}class Ys extends ae{constructor(e){super(),le(this,e,Js,Qs,ie,{playerId:11})}}function jn(n,e,t){const r=n.slice();return r[17]=e[t],r[19]=t,r}function Zs(n){let e;return{c(){e=R("Rollenverteilung")},l(t){e=G(t,"Rollenverteilung")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function eo(n){let e;return{c(){e=R("Schritt 3 von 3")},l(t){e=G(t,"Schritt 3 von 3")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function to(n){let e;return{c(){e=R("Die Rollenverteilung wird von der Spielleitung bernommen.")},l(t){e=G(t,"Die Rollenverteilung wird von der Spielleitung bernommen.")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function no(n){let e=n[0].side==="attacker"?"Angriff":"Verteidigung",t;return{c(){t=R(e)},l(r){t=G(r,e)},m(r,s){S(r,t,s)},p(r,s){s&1&&e!==(e=r[0].side==="attacker"?"Angriff":"Verteidigung")&&oe(t,e)},d(r){r&&$(t)}}}function ro(n){let e;return{c(){e=R(`Es mssen fr jede Rolle ein:e Spieler:in bestimmt und besttigt werden. Die restlichen
    Teilnehmenden knnen das Spielgeschehen beobachten und das Team beraten.`)},l(t){e=G(t,`Es mssen fr jede Rolle ein:e Spieler:in bestimmt und besttigt werden. Die restlichen
    Teilnehmenden knnen das Spielgeschehen beobachten und das Team beraten.`)},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function Dn(n){var f;let e,t,r=((f=n[2].find(l))==null?void 0:f.name)+"",s,o;e=new st({props:{centered:!0,size:"sm",$$slots:{default:[io]},$$scope:{ctx:n}}});function l(...u){return n[14](n[17],...u)}return{c(){V(e.$$.fragment),t=F(),s=R(r)},l(u){U(e.$$.fragment,u),t=C(u),s=G(u,r)},m(u,d){W(e,u,d),S(u,t,d),S(u,s,d),o=!0},p(u,d){var i;n=u;const g={};d&1048578&&(g.$$scope={dirty:d,ctx:n}),e.$set(g),(!o||d&6)&&r!==(r=((i=n[2].find(l))==null?void 0:i.name)+"")&&oe(s,r)},i(u){o||(T(e.$$.fragment,u),o=!0)},o(u){k(e.$$.fragment,u),o=!1},d(u){u&&($(t),$(s)),X(e,u)}}}function io(n){let e=n[17].role+"",t;return{c(){t=R(e)},l(r){t=G(r,e)},m(r,s){S(r,t,s)},p(r,s){s&2&&e!==(e=r[17].role+"")&&oe(t,e)},d(r){r&&$(t)}}}function so(n){let e,t=n[17].isConfigured?"wechseln":`${n[19]+1} bestimmen`,r;return{c(){e=R("Rolle "),r=R(t)},l(s){e=G(s,"Rolle "),r=G(s,t)},m(s,o){S(s,e,o),S(s,r,o)},p(s,o){o&2&&t!==(t=s[17].isConfigured?"wechseln":`${s[19]+1} bestimmen`)&&oe(r,t)},d(s){s&&($(e),$(r))}}}function Ln(n){let e,t,r,s,o,l=n[17].isConfigured&&Dn(n);function f(){return n[15](n[19])}return r=new Pe({props:{size:"small",disabled:!n[3],$$slots:{default:[so]},$$scope:{ctx:n}}}),r.$on("click",f),{c(){e=L("div"),l&&l.c(),t=F(),V(r.$$.fragment),s=F(),this.h()},l(u){e=x(u,"DIV",{class:!0});var d=H(e);l&&l.l(d),t=C(d),U(r.$$.fragment,d),s=C(d),d.forEach($),this.h()},h(){j(e,"class","player svelte-11fuvol")},m(u,d){S(u,e,d),l&&l.m(e,null),P(e,t),W(r,e,null),P(e,s),o=!0},p(u,d){n=u,n[17].isConfigured?l?(l.p(n,d),d&2&&T(l,1)):(l=Dn(n),l.c(),T(l,1),l.m(e,t)):l&&(ne(),k(l,1,1,()=>{l=null}),re());const g={};d&8&&(g.disabled=!n[3]),d&1048578&&(g.$$scope={dirty:d,ctx:n}),r.$set(g)},i(u){o||(T(l),T(r.$$.fragment,u),o=!0)},o(u){k(l),k(r.$$.fragment,u),o=!1},d(u){u&&$(e),l&&l.d(),X(r)}}}function oo(n){let e;return{c(){e=R("Besttigen und weiter")},l(t){e=G(t,"Besttigen und weiter")},m(t,r){S(t,e,r)},d(t){t&&$(e)}}}function xn(n){let e=n[5],t,r,s=Rn(n);return{c(){s.c(),t=ue()},l(o){s.l(o),t=ue()},m(o,l){s.m(o,l),S(o,t,l),r=!0},p(o,l){l&32&&ie(e,e=o[5])?(ne(),k(s,1,1,se),re(),s=Rn(o),s.c(),T(s,1),s.m(t.parentNode,t)):s.p(o,l)},i(o){r||(T(s),r=!0)},o(o){k(s),r=!1},d(o){o&&$(t),s.d(o)}}}function Rn(n){let e,t;return e=new Ys({props:{playerId:n[5]}}),{c(){V(e.$$.fragment)},l(r){U(e.$$.fragment,r)},m(r,s){W(e,r,s),t=!0},p(r,s){const o={};s&32&&(o.playerId=r[5]),e.$set(o)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){X(e,r)}}}function ao(n){let e,t,r,s,o,l,f,u,d,g,i,a,c,_,p;e=new st({props:{separator:!0,$$slots:{info:[eo],default:[Zs]},$$scope:{ctx:n}}}),r=new kn({props:{$$slots:{default:[to]},$$scope:{ctx:n}}}),l=new st({props:{centered:!0,$$slots:{default:[no]},$$scope:{ctx:n}}}),u=new kn({props:{$$slots:{default:[ro]},$$scope:{ctx:n}}});let m=te(n[1]),h=[];for(let v=0;v<m.length;v+=1)h[v]=Ln(jn(n,m,v));const y=v=>k(h[v],1,1,()=>{h[v]=null});a=new Pe({props:{primary:!0,disabled:!n[4],disabledReason:n[0].isAdmin?"Alle Rollen mssen zugewiesen sein":"Nur Administrator:innen drfen besttigen",$$slots:{default:[oo]},$$scope:{ctx:n}}}),a.$on("click",n[16]);let b=n[5]!==void 0&&xn(n);return{c(){V(e.$$.fragment),t=F(),V(r.$$.fragment),s=F(),o=L("section"),V(l.$$.fragment),f=F(),V(u.$$.fragment),d=F(),g=L("div");for(let v=0;v<h.length;v+=1)h[v].c();i=F(),V(a.$$.fragment),c=F(),b&&b.c(),_=ue(),this.h()},l(v){U(e.$$.fragment,v),t=C(v),U(r.$$.fragment,v),s=C(v),o=x(v,"SECTION",{class:!0});var w=H(o);U(l.$$.fragment,w),f=C(w),U(u.$$.fragment,w),d=C(w),g=x(w,"DIV",{class:!0});var I=H(g);for(let A=0;A<h.length;A+=1)h[A].l(I);I.forEach($),w.forEach($),i=C(v),U(a.$$.fragment,v),c=C(v),b&&b.l(v),_=ue(),this.h()},h(){j(g,"class","players svelte-11fuvol"),j(o,"class","svelte-11fuvol")},m(v,w){W(e,v,w),S(v,t,w),W(r,v,w),S(v,s,w),S(v,o,w),W(l,o,null),P(o,f),W(u,o,null),P(o,d),P(o,g);for(let I=0;I<h.length;I+=1)h[I]&&h[I].m(g,null);S(v,i,w),W(a,v,w),S(v,c,w),b&&b.m(v,w),S(v,_,w),p=!0},p(v,[w]){const I={};w&1048576&&(I.$$scope={dirty:w,ctx:v}),e.$set(I);const A={};w&1048576&&(A.$$scope={dirty:w,ctx:v}),r.$set(A);const B={};w&1048577&&(B.$$scope={dirty:w,ctx:v}),l.$set(B);const O={};if(w&1048576&&(O.$$scope={dirty:w,ctx:v}),u.$set(O),w&4175){m=te(v[1]);let N;for(N=0;N<m.length;N+=1){const Q=jn(v,m,N);h[N]?(h[N].p(Q,w),T(h[N],1)):(h[N]=Ln(Q),h[N].c(),T(h[N],1),h[N].m(g,null))}for(ne(),N=m.length;N<h.length;N+=1)y(N);re()}const ee={};w&16&&(ee.disabled=!v[4]),w&1&&(ee.disabledReason=v[0].isAdmin?"Alle Rollen mssen zugewiesen sein":"Nur Administrator:innen drfen besttigen"),w&1048576&&(ee.$$scope={dirty:w,ctx:v}),a.$set(ee),v[5]!==void 0?b?(b.p(v,w),w&32&&T(b,1)):(b=xn(v),b.c(),T(b,1),b.m(_.parentNode,_)):b&&(ne(),k(b,1,1,()=>{b=null}),re())},i(v){if(!p){T(e.$$.fragment,v),T(r.$$.fragment,v),T(l.$$.fragment,v),T(u.$$.fragment,v);for(let w=0;w<m.length;w+=1)T(h[w]);T(a.$$.fragment,v),T(b),p=!0}},o(v){k(e.$$.fragment,v),k(r.$$.fragment,v),k(l.$$.fragment,v),k(u.$$.fragment,v),h=h.filter(Boolean);for(let w=0;w<h.length;w+=1)k(h[w]);k(a.$$.fragment,v),k(b),p=!1},d(v){v&&($(t),$(s),$(o),$(i),$(c),$(_)),X(e,v),X(r,v),X(l),X(u),Ne(h,v),X(a,v),b&&b.d(v)}}}function lo(n,e,t){let r,s,o,l,f,u;const{machine:d,user:g}=we();K(n,g,v=>t(0,r=v));const i=Y(d.service,({context:v})=>(r.side==="attacker"?v.attack:v.defense).editingPlayer);K(n,i,v=>t(5,u=v));const a=Y(d.service,({context:v})=>r.side==="attacker"?[v.attack.attacker]:v.defense.defenders);K(n,a,v=>t(1,s=v));const c=Y(d.service,v=>v.can({type:"start editing player",playerId:1}));K(n,c,v=>t(3,l=v));const _=Y(d.service,v=>v.can({type:"next step"}));K(n,_,v=>t(4,f=v));const p=v=>v,m=Y(d.service,({context:v})=>v.users);return K(n,m,v=>t(2,o=v)),[r,s,o,l,f,u,d,g,i,a,c,_,p,m,(v,w)=>w.id===v.userId,v=>d.send({type:"start editing player",playerId:r.side==="attacker"?"attacker":p(v)}),()=>d.send({type:"next step"})]}class co extends ae{constructor(e){super(),le(this,e,lo,ao,ie,{})}}function uo(n){let e;return{c(){e=R("Unknown state")},l(t){e=G(t,"Unknown state")},m(t,r){S(t,e,r)},i:se,o:se,d(t){t&&$(e)}}}function fo(n){let e;return{c(){e=R("Waiting for other side")},l(t){e=G(t,"Waiting for other side")},m(t,r){S(t,e,r)},i:se,o:se,d(t){t&&$(e)}}}function _o(n){let e,t;return e=new co({}),{c(){V(e.$$.fragment)},l(r){U(e.$$.fragment,r)},m(r,s){W(e,r,s),t=!0},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){X(e,r)}}}function po(n){let e,t;return e=new Ws({}),{c(){V(e.$$.fragment)},l(r){U(e.$$.fragment,r)},m(r,s){W(e,r,s),t=!0},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){X(e,r)}}}function ho(n){let e,t,r,s;const o=[po,_o,fo,uo],l=[];function f(u,d){return u[0]==="Assigning sides"?0:u[0]==="Assigning roles"?1:u[0]==="Waiting for other side"?2:3}return e=f(n),t=l[e]=o[e](n),{c(){t.c(),r=ue()},l(u){t.l(u),r=ue()},m(u,d){l[e].m(u,d),S(u,r,d),s=!0},p(u,[d]){let g=e;e=f(u),e!==g&&(ne(),k(l[g],1,1,()=>{l[g]=null}),re(),t=l[e],t||(t=l[e]=o[e](u),t.c()),T(t,1),t.m(r.parentNode,r))},i(u){s||(T(t),s=!0)},o(u){k(t),s=!1},d(u){u&&$(r),l[e].d(u)}}}function go(n,e,t){let r;const{machine:s}=we(),o=Y(s.service,l=>{let f;return l.matches("Lobby.Assigning sides")?f="Assigning sides":l.matches("Lobby.Assigning roles")?f="Assigning roles":l.matches("Lobby.Waiting for other side")&&(f="Waiting for other side"),f});return K(n,o,l=>t(0,r=l)),[r,o]}class mo extends ae{constructor(e){super(),le(this,e,go,ho,ie,{})}}const vo=n=>({}),Gn=n=>({}),yo=n=>({}),Hn=n=>({}),bo=n=>({}),Fn=n=>({});function wo(n){let e;return{c(){e=R("...")},l(t){e=G(t,"...")},m(t,r){S(t,e,r)},i:se,o:se,d(t){t&&$(e)}}}function $o(n){let e,t;return e=new mo({}),{c(){V(e.$$.fragment)},l(r){U(e.$$.fragment,r)},m(r,s){W(e,r,s),t=!0},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){X(e,r)}}}function Ao(n){let e,t,r,s="The Hidden Threat",o,l,f,u,d,g,i,a,c,_,p,m,h,y,b;const v=n[8].items,w=Se(v,n,n[7],Fn),I=n[8].actions,A=Se(I,n,n[7],Hn),B=[$o,wo],O=[];function ee(D,z){return D[3]==="Lobby"?0:1}c=ee(n),_=O[c]=B[c](n);const N=n[8]["cursor-overlays"],Q=Se(N,n,n[7],Gn);return{c(){e=L("div"),t=L("div"),r=L("div"),r.textContent=s,o=F(),l=L("div"),f=F(),u=L("div"),w&&w.c(),d=F(),g=L("div"),A&&A.c(),i=F(),a=L("div"),_.c(),p=F(),Q&&Q.c(),this.h()},l(D){e=x(D,"DIV",{class:!0});var z=H(e);t=x(z,"DIV",{class:!0});var J=H(t);r=x(J,"DIV",{class:!0,"data-svelte-h":!0}),ct(r)!=="svelte-iqe0dn"&&(r.textContent=s),o=C(J),l=x(J,"DIV",{class:!0}),H(l).forEach($),f=C(J),u=x(J,"DIV",{class:!0});var zt=H(u);w&&w.l(zt),zt.forEach($),d=C(J),g=x(J,"DIV",{class:!0});var Kt=H(g);A&&A.l(Kt),Kt.forEach($),i=C(J),a=x(J,"DIV",{class:!0});var Qt=H(a);_.l(Qt),Qt.forEach($),p=C(J),Q&&Q.l(J),J.forEach($),z.forEach($),this.h()},h(){j(r,"class","name svelte-k0wvqu"),j(l,"class","characters svelte-k0wvqu"),j(u,"class","items svelte-k0wvqu"),j(g,"class","actions svelte-k0wvqu"),j(a,"class","content svelte-k0wvqu"),j(t,"class","game svelte-k0wvqu"),Ht(()=>n[10].call(t)),j(e,"class","game-wrapper svelte-k0wvqu")},m(D,z){S(D,e,z),P(e,t),P(t,r),P(t,o),P(t,l),P(t,f),P(t,u),w&&w.m(u,null),P(t,d),P(t,g),A&&A.m(g,null),P(t,i),P(t,a),O[c].m(a,null),P(t,p),Q&&Q.m(t,null),n[9](t),m=vr(t,n[10].bind(t)),h=!0,y||(b=Oe(t,"mousemove",n[4]),y=!0)},p(D,[z]){w&&w.p&&(!h||z&128)&&ke(w,v,D,D[7],h?Ee(v,D[7],z,bo):Ie(D[7]),Fn),A&&A.p&&(!h||z&128)&&ke(A,I,D,D[7],h?Ee(I,D[7],z,yo):Ie(D[7]),Hn);let J=c;c=ee(D),c!==J&&(ne(),k(O[J],1,1,()=>{O[J]=null}),re(),_=O[c],_||(_=O[c]=B[c](D),_.c()),T(_,1),_.m(a,null)),Q&&Q.p&&(!h||z&128)&&ke(Q,N,D,D[7],h?Ee(N,D[7],z,vo):Ie(D[7]),Gn)},i(D){h||(T(w,D),T(A,D),T(_),T(Q,D),h=!0)},o(D){k(w,D),k(A,D),k(_),k(Q,D),h=!1},d(D){D&&$(e),w&&w.d(D),A&&A.d(D),O[c].d(),Q&&Q.d(D),n[9](null),m(),y=!1,b()}}}function To(n,e,t){let r,{$$slots:s={},$$scope:o}=e;const{machine:l}=we();let{reportMousePosition:f}=e,u,d=1,g=1;const i=p=>{const m=window.matchMedia("(width < 1200px) or (height < 675px)").matches?.6:window.matchMedia("(width < 1200px) or (height < 675px)").matches?.8:1,h=(p.clientX-u.offsetLeft)/d,y=(p.clientY-u.offsetTop)/g;f([(h-(1-m)/2)/m,(y-(1-m)/2)/m])},a=Y(l.service,p=>{let m;return p.matches("Lobby")&&(m="Lobby"),m});K(n,a,p=>t(3,r=p));function c(p){Gt[p?"unshift":"push"](()=>{u=p,t(0,u)})}function _(){d=this.clientWidth,g=this.clientHeight,t(1,d),t(2,g)}return n.$$set=p=>{"reportMousePosition"in p&&t(6,f=p.reportMousePosition),"$$scope"in p&&t(7,o=p.$$scope)},[u,d,g,r,i,a,f,o,s,c,_]}class So extends ae{constructor(e){super(),le(this,e,To,Ao,ie,{reportMousePosition:6})}}var de=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Br(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var qr={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(n){(function(){var e=function(){this.init()};e.prototype={init:function(){var i=this||t;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var a=this||t;if(i=parseFloat(i),a.ctx||g(),typeof i<"u"&&i>=0&&i<=1){if(a._volume=i,a._muted)return a;a.usingWebAudio&&a.masterGain.gain.setValueAtTime(i,t.ctx.currentTime);for(var c=0;c<a._howls.length;c++)if(!a._howls[c]._webAudio)for(var _=a._howls[c]._getSoundIds(),p=0;p<_.length;p++){var m=a._howls[c]._soundById(_[p]);m&&m._node&&(m._node.volume=m._volume*i)}return a}return a._volume},mute:function(i){var a=this||t;a.ctx||g(),a._muted=i,a.usingWebAudio&&a.masterGain.gain.setValueAtTime(i?0:a._volume,t.ctx.currentTime);for(var c=0;c<a._howls.length;c++)if(!a._howls[c]._webAudio)for(var _=a._howls[c]._getSoundIds(),p=0;p<_.length;p++){var m=a._howls[c]._soundById(_[p]);m&&m._node&&(m._node.muted=i?!0:m._muted)}return a},stop:function(){for(var i=this||t,a=0;a<i._howls.length;a++)i._howls[a].stop();return i},unload:function(){for(var i=this||t,a=i._howls.length-1;a>=0;a--)i._howls[a].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,g()),i},codecs:function(i){return(this||t)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||t;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var a=new Audio;typeof a.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var a=new Audio;a.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||t,a=null;try{a=typeof Audio<"u"?new Audio:null}catch{return i}if(!a||typeof a.canPlayType!="function")return i;var c=a.canPlayType("audio/mpeg;").replace(/^no$/,""),_=i._navigator?i._navigator.userAgent:"",p=_.match(/OPR\/([0-6].)/g),m=p&&parseInt(p[0].split("/")[1],10)<33,h=_.indexOf("Safari")!==-1&&_.indexOf("Chrome")===-1,y=_.match(/Version\/(.*?) /),b=h&&y&&parseInt(y[1],10)<15;return i._codecs={mp3:!!(!m&&(c||a.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!c,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(a.canPlayType('audio/wav; codecs="1"')||a.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(a.canPlayType("audio/x-m4b;")||a.canPlayType("audio/m4b;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(a.canPlayType("audio/x-flac;")||a.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||t;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var a=function(c){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var _=new Audio;_._unlocked=!0,i._releaseHtml5Audio(_)}catch{i.noAudio=!0;break}for(var p=0;p<i._howls.length;p++)if(!i._howls[p]._webAudio)for(var m=i._howls[p]._getSoundIds(),h=0;h<m.length;h++){var y=i._howls[p]._soundById(m[h]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}i._autoResume();var b=i.ctx.createBufferSource();b.buffer=i._scratchBuffer,b.connect(i.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),b.onended=function(){b.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",a,!0),document.removeEventListener("touchend",a,!0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",a,!0);for(var v=0;v<i._howls.length;v++)i._howls[v]._emit("unlock")}};return document.addEventListener("touchstart",a,!0),document.addEventListener("touchend",a,!0),document.addEventListener("click",a,!0),document.addEventListener("keydown",a,!0),i}},_obtainHtml5Audio:function(){var i=this||t;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var a=new Audio().play();return a&&typeof Promise<"u"&&(a instanceof Promise||typeof a.then=="function")&&a.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var a=this||t;return i._unlocked&&a._html5AudioPool.push(i),a},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!t.usingWebAudio)){for(var a=0;a<i._howls.length;a++)if(i._howls[a]._webAudio){for(var c=0;c<i._howls[a]._sounds.length;c++)if(!i._howls[a]._sounds[c]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var _=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(_,_)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!t.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var a=0;a<i._howls.length;a++)i._howls[a]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var t=new e,r=function(i){var a=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}a.init(i)};r.prototype={init:function(i){var a=this;return t.ctx||g(),a._autoplay=i.autoplay||!1,a._format=typeof i.format!="string"?i.format:[i.format],a._html5=i.html5||!1,a._muted=i.mute||!1,a._loop=i.loop||!1,a._pool=i.pool||5,a._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,a._rate=i.rate||1,a._sprite=i.sprite||{},a._src=typeof i.src!="string"?i.src:[i.src],a._volume=i.volume!==void 0?i.volume:1,a._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._playLock=!1,a._onend=i.onend?[{fn:i.onend}]:[],a._onfade=i.onfade?[{fn:i.onfade}]:[],a._onload=i.onload?[{fn:i.onload}]:[],a._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],a._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],a._onpause=i.onpause?[{fn:i.onpause}]:[],a._onplay=i.onplay?[{fn:i.onplay}]:[],a._onstop=i.onstop?[{fn:i.onstop}]:[],a._onmute=i.onmute?[{fn:i.onmute}]:[],a._onvolume=i.onvolume?[{fn:i.onvolume}]:[],a._onrate=i.onrate?[{fn:i.onrate}]:[],a._onseek=i.onseek?[{fn:i.onseek}]:[],a._onunlock=i.onunlock?[{fn:i.onunlock}]:[],a._onresume=[],a._webAudio=t.usingWebAudio&&!a._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(a),a._autoplay&&a._queue.push({event:"play",action:function(){a.play()}}),a._preload&&a._preload!=="none"&&a.load(),a},load:function(){var i=this,a=null;if(t.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var c=0;c<i._src.length;c++){var _,p;if(i._format&&i._format[c])_=i._format[c];else{if(p=i._src[c],typeof p!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}_=/^data:audio\/([^;,]+);/i.exec(p),_||(_=/\.([^.]+)$/.exec(p.split("?",1)[0])),_&&(_=_[1].toLowerCase())}if(_||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),_&&t.codecs(_)){a=i._src[c];break}}if(!a){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=a,i._state="loading",window.location.protocol==="https:"&&a.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new s(i),i._webAudio&&l(i),i},play:function(i,a){var c=this,_=null;if(typeof i=="number")_=i,i=null;else{if(typeof i=="string"&&c._state==="loaded"&&!c._sprite[i])return null;if(typeof i>"u"&&(i="__default",!c._playLock)){for(var p=0,m=0;m<c._sounds.length;m++)c._sounds[m]._paused&&!c._sounds[m]._ended&&(p++,_=c._sounds[m]._id);p===1?i=null:_=null}}var h=_?c._soundById(_):c._inactiveSound();if(!h)return null;if(_&&!i&&(i=h._sprite||"__default"),c._state!=="loaded"){h._sprite=i,h._ended=!1;var y=h._id;return c._queue.push({event:"play",action:function(){c.play(y)}}),y}if(_&&!h._paused)return a||c._loadQueue("play"),h._id;c._webAudio&&t._autoResume();var b=Math.max(0,h._seek>0?h._seek:c._sprite[i][0]/1e3),v=Math.max(0,(c._sprite[i][0]+c._sprite[i][1])/1e3-b),w=v*1e3/Math.abs(h._rate),I=c._sprite[i][0]/1e3,A=(c._sprite[i][0]+c._sprite[i][1])/1e3;h._sprite=i,h._ended=!1;var B=function(){h._paused=!1,h._seek=b,h._start=I,h._stop=A,h._loop=!!(h._loop||c._sprite[i][2])};if(b>=A){c._ended(h);return}var O=h._node;if(c._webAudio){var ee=function(){c._playLock=!1,B(),c._refreshBuffer(h);var z=h._muted||c._muted?0:h._volume;O.gain.setValueAtTime(z,t.ctx.currentTime),h._playStart=t.ctx.currentTime,typeof O.bufferSource.start>"u"?h._loop?O.bufferSource.noteGrainOn(0,b,86400):O.bufferSource.noteGrainOn(0,b,v):h._loop?O.bufferSource.start(0,b,86400):O.bufferSource.start(0,b,v),w!==1/0&&(c._endTimers[h._id]=setTimeout(c._ended.bind(c,h),w)),a||setTimeout(function(){c._emit("play",h._id),c._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?ee():(c._playLock=!0,c.once("resume",ee),c._clearTimer(h._id))}else{var N=function(){O.currentTime=b,O.muted=h._muted||c._muted||t._muted||O.muted,O.volume=h._volume*t.volume(),O.playbackRate=h._rate;try{var z=O.play();if(z&&typeof Promise<"u"&&(z instanceof Promise||typeof z.then=="function")?(c._playLock=!0,B(),z.then(function(){c._playLock=!1,O._unlocked=!0,a?c._loadQueue():c._emit("play",h._id)}).catch(function(){c._playLock=!1,c._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),h._ended=!0,h._paused=!0})):a||(c._playLock=!1,B(),c._emit("play",h._id)),O.playbackRate=h._rate,O.paused){c._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||h._loop?c._endTimers[h._id]=setTimeout(c._ended.bind(c,h),w):(c._endTimers[h._id]=function(){c._ended(h),O.removeEventListener("ended",c._endTimers[h._id],!1)},O.addEventListener("ended",c._endTimers[h._id],!1))}catch(J){c._emit("playerror",h._id,J)}};O.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(O.src=c._src,O.load());var Q=window&&window.ejecta||!O.readyState&&t._navigator.isCocoonJS;if(O.readyState>=3||Q)N();else{c._playLock=!0,c._state="loading";var D=function(){c._state="loaded",N(),O.removeEventListener(t._canPlayEvent,D,!1)};O.addEventListener(t._canPlayEvent,D,!1),c._clearTimer(h._id)}}return h._id},pause:function(i){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"pause",action:function(){a.pause(i)}}),a;for(var c=a._getSoundIds(i),_=0;_<c.length;_++){a._clearTimer(c[_]);var p=a._soundById(c[_]);if(p&&!p._paused&&(p._seek=a.seek(c[_]),p._rateSeek=0,p._paused=!0,a._stopFade(c[_]),p._node))if(a._webAudio){if(!p._node.bufferSource)continue;typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),a._cleanBuffer(p._node)}else(!isNaN(p._node.duration)||p._node.duration===1/0)&&p._node.pause();arguments[1]||a._emit("pause",p?p._id:null)}return a},stop:function(i,a){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"stop",action:function(){c.stop(i)}}),c;for(var _=c._getSoundIds(i),p=0;p<_.length;p++){c._clearTimer(_[p]);var m=c._soundById(_[p]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,c._stopFade(_[p]),m._node&&(c._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),c._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&c._clearSound(m._node))),a||c._emit("stop",m._id))}return c},mute:function(i,a){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"mute",action:function(){c.mute(i,a)}}),c;if(typeof a>"u")if(typeof i=="boolean")c._muted=i;else return c._muted;for(var _=c._getSoundIds(a),p=0;p<_.length;p++){var m=c._soundById(_[p]);m&&(m._muted=i,m._interval&&c._stopFade(m._id),c._webAudio&&m._node?m._node.gain.setValueAtTime(i?0:m._volume,t.ctx.currentTime):m._node&&(m._node.muted=t._muted?!0:i),c._emit("mute",m._id))}return c},volume:function(){var i=this,a=arguments,c,_;if(a.length===0)return i._volume;if(a.length===1||a.length===2&&typeof a[1]>"u"){var p=i._getSoundIds(),m=p.indexOf(a[0]);m>=0?_=parseInt(a[0],10):c=parseFloat(a[0])}else a.length>=2&&(c=parseFloat(a[0]),_=parseInt(a[1],10));var h;if(typeof c<"u"&&c>=0&&c<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,a)}}),i;typeof _>"u"&&(i._volume=c),_=i._getSoundIds(_);for(var y=0;y<_.length;y++)h=i._soundById(_[y]),h&&(h._volume=c,a[2]||i._stopFade(_[y]),i._webAudio&&h._node&&!h._muted?h._node.gain.setValueAtTime(c,t.ctx.currentTime):h._node&&!h._muted&&(h._node.volume=c*t.volume()),i._emit("volume",h._id))}else return h=_?i._soundById(_):i._sounds[0],h?h._volume:0;return i},fade:function(i,a,c,_){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"fade",action:function(){p.fade(i,a,c,_)}}),p;i=Math.min(Math.max(0,parseFloat(i)),1),a=Math.min(Math.max(0,parseFloat(a)),1),c=parseFloat(c),p.volume(i,_);for(var m=p._getSoundIds(_),h=0;h<m.length;h++){var y=p._soundById(m[h]);if(y){if(_||p._stopFade(m[h]),p._webAudio&&!y._muted){var b=t.ctx.currentTime,v=b+c/1e3;y._volume=i,y._node.gain.setValueAtTime(i,b),y._node.gain.linearRampToValueAtTime(a,v)}p._startFadeInterval(y,i,a,c,m[h],typeof _>"u")}}return p},_startFadeInterval:function(i,a,c,_,p,m){var h=this,y=a,b=c-a,v=Math.abs(b/.01),w=Math.max(4,v>0?_/v:_),I=Date.now();i._fadeTo=c,i._interval=setInterval(function(){var A=(Date.now()-I)/_;I=Date.now(),y+=b*A,y=Math.round(y*100)/100,b<0?y=Math.max(c,y):y=Math.min(c,y),h._webAudio?i._volume=y:h.volume(y,i._id,!0),m&&(h._volume=y),(c<a&&y<=c||c>a&&y>=c)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,h.volume(c,i._id),h._emit("fade",i._id))},w)},_stopFade:function(i){var a=this,c=a._soundById(i);return c&&c._interval&&(a._webAudio&&c._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(c._interval),c._interval=null,a.volume(c._fadeTo,i),c._fadeTo=null,a._emit("fade",i)),a},loop:function(){var i=this,a=arguments,c,_,p;if(a.length===0)return i._loop;if(a.length===1)if(typeof a[0]=="boolean")c=a[0],i._loop=c;else return p=i._soundById(parseInt(a[0],10)),p?p._loop:!1;else a.length===2&&(c=a[0],_=parseInt(a[1],10));for(var m=i._getSoundIds(_),h=0;h<m.length;h++)p=i._soundById(m[h]),p&&(p._loop=c,i._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=c,c&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop,i.playing(m[h])&&(i.pause(m[h],!0),i.play(m[h],!0)))));return i},rate:function(){var i=this,a=arguments,c,_;if(a.length===0)_=i._sounds[0]._id;else if(a.length===1){var p=i._getSoundIds(),m=p.indexOf(a[0]);m>=0?_=parseInt(a[0],10):c=parseFloat(a[0])}else a.length===2&&(c=parseFloat(a[0]),_=parseInt(a[1],10));var h;if(typeof c=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,a)}}),i;typeof _>"u"&&(i._rate=c),_=i._getSoundIds(_);for(var y=0;y<_.length;y++)if(h=i._soundById(_[y]),h){i.playing(_[y])&&(h._rateSeek=i.seek(_[y]),h._playStart=i._webAudio?t.ctx.currentTime:h._playStart),h._rate=c,i._webAudio&&h._node&&h._node.bufferSource?h._node.bufferSource.playbackRate.setValueAtTime(c,t.ctx.currentTime):h._node&&(h._node.playbackRate=c);var b=i.seek(_[y]),v=(i._sprite[h._sprite][0]+i._sprite[h._sprite][1])/1e3-b,w=v*1e3/Math.abs(h._rate);(i._endTimers[_[y]]||!h._paused)&&(i._clearTimer(_[y]),i._endTimers[_[y]]=setTimeout(i._ended.bind(i,h),w)),i._emit("rate",h._id)}}else return h=i._soundById(_),h?h._rate:i._rate;return i},seek:function(){var i=this,a=arguments,c,_;if(a.length===0)i._sounds.length&&(_=i._sounds[0]._id);else if(a.length===1){var p=i._getSoundIds(),m=p.indexOf(a[0]);m>=0?_=parseInt(a[0],10):i._sounds.length&&(_=i._sounds[0]._id,c=parseFloat(a[0]))}else a.length===2&&(c=parseFloat(a[0]),_=parseInt(a[1],10));if(typeof _>"u")return 0;if(typeof c=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,a)}}),i;var h=i._soundById(_);if(h)if(typeof c=="number"&&c>=0){var y=i.playing(_);y&&i.pause(_,!0),h._seek=c,h._ended=!1,i._clearTimer(_),!i._webAudio&&h._node&&!isNaN(h._node.duration)&&(h._node.currentTime=c);var b=function(){y&&i.play(_,!0),i._emit("seek",_)};if(y&&!i._webAudio){var v=function(){i._playLock?setTimeout(v,0):b()};setTimeout(v,0)}else b()}else if(i._webAudio){var w=i.playing(_)?t.ctx.currentTime-h._playStart:0,I=h._rateSeek?h._rateSeek-h._seek:0;return h._seek+(I+w*Math.abs(h._rate))}else return h._node.currentTime;return i},playing:function(i){var a=this;if(typeof i=="number"){var c=a._soundById(i);return c?!c._paused:!1}for(var _=0;_<a._sounds.length;_++)if(!a._sounds[_]._paused)return!0;return!1},duration:function(i){var a=this,c=a._duration,_=a._soundById(i);return _&&(c=a._sprite[_._sprite][1]/1e3),c},state:function(){return this._state},unload:function(){for(var i=this,a=i._sounds,c=0;c<a.length;c++)a[c]._paused||i.stop(a[c]._id),i._webAudio||(i._clearSound(a[c]._node),a[c]._node.removeEventListener("error",a[c]._errorFn,!1),a[c]._node.removeEventListener(t._canPlayEvent,a[c]._loadFn,!1),a[c]._node.removeEventListener("ended",a[c]._endFn,!1),t._releaseHtml5Audio(a[c]._node)),delete a[c]._node,i._clearTimer(a[c]._id);var _=t._howls.indexOf(i);_>=0&&t._howls.splice(_,1);var p=!0;for(c=0;c<t._howls.length;c++)if(t._howls[c]._src===i._src||i._src.indexOf(t._howls[c]._src)>=0){p=!1;break}return o&&p&&delete o[i._src],t.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,a,c,_){var p=this,m=p["_on"+i];return typeof a=="function"&&m.push(_?{id:c,fn:a,once:_}:{id:c,fn:a}),p},off:function(i,a,c){var _=this,p=_["_on"+i],m=0;if(typeof a=="number"&&(c=a,a=null),a||c)for(m=0;m<p.length;m++){var h=c===p[m].id;if(a===p[m].fn&&h||!a&&h){p.splice(m,1);break}}else if(i)_["_on"+i]=[];else{var y=Object.keys(_);for(m=0;m<y.length;m++)y[m].indexOf("_on")===0&&Array.isArray(_[y[m]])&&(_[y[m]]=[])}return _},once:function(i,a,c){var _=this;return _.on(i,a,c,1),_},_emit:function(i,a,c){for(var _=this,p=_["_on"+i],m=p.length-1;m>=0;m--)(!p[m].id||p[m].id===a||i==="load")&&(setTimeout((function(h){h.call(this,a,c)}).bind(_,p[m].fn),0),p[m].once&&_.off(i,p[m].fn,p[m].id));return _._loadQueue(i),_},_loadQueue:function(i){var a=this;if(a._queue.length>0){var c=a._queue[0];c.event===i&&(a._queue.shift(),a._loadQueue()),i||c.action()}return a},_ended:function(i){var a=this,c=i._sprite;if(!a._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(a._ended.bind(a,i),100),a;var _=!!(i._loop||a._sprite[c][2]);if(a._emit("end",i._id),!a._webAudio&&_&&a.stop(i._id,!0).play(i._id),a._webAudio&&_){a._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=t.ctx.currentTime;var p=(i._stop-i._start)*1e3/Math.abs(i._rate);a._endTimers[i._id]=setTimeout(a._ended.bind(a,i),p)}return a._webAudio&&!_&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,a._clearTimer(i._id),a._cleanBuffer(i._node),t._autoSuspend()),!a._webAudio&&!_&&a.stop(i._id,!0),a},_clearTimer:function(i){var a=this;if(a._endTimers[i]){if(typeof a._endTimers[i]!="function")clearTimeout(a._endTimers[i]);else{var c=a._soundById(i);c&&c._node&&c._node.removeEventListener("ended",a._endTimers[i],!1)}delete a._endTimers[i]}return a},_soundById:function(i){for(var a=this,c=0;c<a._sounds.length;c++)if(i===a._sounds[c]._id)return a._sounds[c];return null},_inactiveSound:function(){var i=this;i._drain();for(var a=0;a<i._sounds.length;a++)if(i._sounds[a]._ended)return i._sounds[a].reset();return new s(i)},_drain:function(){var i=this,a=i._pool,c=0,_=0;if(!(i._sounds.length<a)){for(_=0;_<i._sounds.length;_++)i._sounds[_]._ended&&c++;for(_=i._sounds.length-1;_>=0;_--){if(c<=a)return;i._sounds[_]._ended&&(i._webAudio&&i._sounds[_]._node&&i._sounds[_]._node.disconnect(0),i._sounds.splice(_,1),c--)}}},_getSoundIds:function(i){var a=this;if(typeof i>"u"){for(var c=[],_=0;_<a._sounds.length;_++)c.push(a._sounds[_]._id);return c}else return[i]},_refreshBuffer:function(i){var a=this;return i._node.bufferSource=t.ctx.createBufferSource(),i._node.bufferSource.buffer=o[a._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,t.ctx.currentTime),a},_cleanBuffer:function(i){var a=this,c=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),c))try{i.bufferSource.buffer=t._scratchBuffer}catch{}return i.bufferSource=null,a},_clearSound:function(i){var a=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);a||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(i){this._parent=i,this.init()};s.prototype={init:function(){var i=this,a=i._parent;return i._muted=a._muted,i._loop=a._loop,i._volume=a._volume,i._rate=a._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,a._sounds.push(i),i.create(),i},create:function(){var i=this,a=i._parent,c=t._muted||i._muted||i._parent._muted?0:i._volume;return a._webAudio?(i._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),i._node.gain.setValueAtTime(c,t.ctx.currentTime),i._node.paused=!0,i._node.connect(t.masterGain)):t.noAudio||(i._node=t._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(t._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=a._src,i._node.preload=a._preload===!0?"auto":a._preload,i._node.volume=c*t.volume(),i._node.load()),i},reset:function(){var i=this,a=i._parent;return i._muted=a._muted,i._loop=a._loop,i._volume=a._volume,i._rate=a._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++t._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,a=i._parent;a._duration=Math.ceil(i._node.duration*10)/10,Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue()),i._node.removeEventListener(t._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,a=i._parent;a._duration===1/0&&(a._duration=Math.ceil(i._node.duration*10)/10,a._sprite.__default[1]===1/0&&(a._sprite.__default[1]=a._duration*1e3),a._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var o={},l=function(i){var a=i._src;if(o[a]){i._duration=o[a].duration,d(i);return}if(/^data:[^;]+;base64,/.test(a)){for(var c=atob(a.split(",")[1]),_=new Uint8Array(c.length),p=0;p<c.length;++p)_[p]=c.charCodeAt(p);u(_.buffer,i)}else{var m=new XMLHttpRequest;m.open(i._xhr.method,a,!0),m.withCredentials=i._xhr.withCredentials,m.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(h){m.setRequestHeader(h,i._xhr.headers[h])}),m.onload=function(){var h=(m.status+"")[0];if(h!=="0"&&h!=="2"&&h!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}u(m.response,i)},m.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete o[a],i.load())},f(m)}},f=function(i){try{i.send()}catch{i.onerror()}},u=function(i,a){var c=function(){a._emit("loaderror",null,"Decoding audio data failed.")},_=function(p){p&&a._sounds.length>0?(o[a._src]=p,d(a,p)):c()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(i).then(_).catch(c):t.ctx.decodeAudioData(i,_,c)},d=function(i,a){a&&!i._duration&&(i._duration=a.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},g=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),a=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),c=a?parseInt(a[1],10):null;if(i&&c&&c<9){var _=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!_&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};n.Howler=t,n.Howl=r,typeof de<"u"?(de.HowlerGlobal=e,de.Howler=t,de.Howl=r,de.Sound=s):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=r,window.Sound=s)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var s=r._howls.length-1;s>=0;s--)r._howls[s].stereo(t);return r},HowlerGlobal.prototype.pos=function(t,r,s){var o=this;if(!o.ctx||!o.ctx.listener)return o;if(r=typeof r!="number"?o._pos[1]:r,s=typeof s!="number"?o._pos[2]:s,typeof t=="number")o._pos=[t,r,s],typeof o.ctx.listener.positionX<"u"?(o.ctx.listener.positionX.setTargetAtTime(o._pos[0],Howler.ctx.currentTime,.1),o.ctx.listener.positionY.setTargetAtTime(o._pos[1],Howler.ctx.currentTime,.1),o.ctx.listener.positionZ.setTargetAtTime(o._pos[2],Howler.ctx.currentTime,.1)):o.ctx.listener.setPosition(o._pos[0],o._pos[1],o._pos[2]);else return o._pos;return o},HowlerGlobal.prototype.orientation=function(t,r,s,o,l,f){var u=this;if(!u.ctx||!u.ctx.listener)return u;var d=u._orientation;if(r=typeof r!="number"?d[1]:r,s=typeof s!="number"?d[2]:s,o=typeof o!="number"?d[3]:o,l=typeof l!="number"?d[4]:l,f=typeof f!="number"?d[5]:f,typeof t=="number")u._orientation=[t,r,s,o,l,f],typeof u.ctx.listener.forwardX<"u"?(u.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),u.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),u.ctx.listener.forwardZ.setTargetAtTime(s,Howler.ctx.currentTime,.1),u.ctx.listener.upX.setTargetAtTime(o,Howler.ctx.currentTime,.1),u.ctx.listener.upY.setTargetAtTime(l,Howler.ctx.currentTime,.1),u.ctx.listener.upZ.setTargetAtTime(f,Howler.ctx.currentTime,.1)):u.ctx.listener.setOrientation(t,r,s,o,l,f);else return d;return u},Howl.prototype.init=function(t){return function(r){var s=this;return s._orientation=r.orientation||[1,0,0],s._stereo=r.stereo||null,s._pos=r.pos||null,s._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},s._onstereo=r.onstereo?[{fn:r.onstereo}]:[],s._onpos=r.onpos?[{fn:r.onpos}]:[],s._onorientation=r.onorientation?[{fn:r.onorientation}]:[],t.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,r){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"stereo",action:function(){s.stereo(t,r)}}),s;var o=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof t=="number")s._stereo=t,s._pos=[t,0,0];else return s._stereo;for(var l=s._getSoundIds(r),f=0;f<l.length;f++){var u=s._soundById(l[f]);if(u)if(typeof t=="number")u._stereo=t,u._pos=[t,0,0],u._node&&(u._pannerAttr.panningModel="equalpower",(!u._panner||!u._panner.pan)&&e(u,o),o==="spatial"?typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):u._panner.setPosition(t,0,0):u._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),s._emit("stereo",u._id);else return u._stereo}return s},Howl.prototype.pos=function(t,r,s,o){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"pos",action:function(){l.pos(t,r,s,o)}}),l;if(r=typeof r!="number"?0:r,s=typeof s!="number"?-.5:s,typeof o>"u")if(typeof t=="number")l._pos=[t,r,s];else return l._pos;for(var f=l._getSoundIds(o),u=0;u<f.length;u++){var d=l._soundById(f[u]);if(d)if(typeof t=="number")d._pos=[t,r,s],d._node&&((!d._panner||d._panner.pan)&&e(d,"spatial"),typeof d._panner.positionX<"u"?(d._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(s,Howler.ctx.currentTime)):d._panner.setPosition(t,r,s)),l._emit("pos",d._id);else return d._pos}return l},Howl.prototype.orientation=function(t,r,s,o){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"orientation",action:function(){l.orientation(t,r,s,o)}}),l;if(r=typeof r!="number"?l._orientation[1]:r,s=typeof s!="number"?l._orientation[2]:s,typeof o>"u")if(typeof t=="number")l._orientation=[t,r,s];else return l._orientation;for(var f=l._getSoundIds(o),u=0;u<f.length;u++){var d=l._soundById(f[u]);if(d)if(typeof t=="number")d._orientation=[t,r,s],d._node&&(d._panner||(d._pos||(d._pos=l._pos||[0,0,-.5]),e(d,"spatial")),typeof d._panner.orientationX<"u"?(d._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),d._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),d._panner.orientationZ.setValueAtTime(s,Howler.ctx.currentTime)):d._panner.setOrientation(t,r,s)),l._emit("orientation",d._id);else return d._orientation}return l},Howl.prototype.pannerAttr=function(){var t=this,r=arguments,s,o,l;if(!t._webAudio)return t;if(r.length===0)return t._pannerAttr;if(r.length===1)if(typeof r[0]=="object")s=r[0],typeof o>"u"&&(s.pannerAttr||(s.pannerAttr={coneInnerAngle:s.coneInnerAngle,coneOuterAngle:s.coneOuterAngle,coneOuterGain:s.coneOuterGain,distanceModel:s.distanceModel,maxDistance:s.maxDistance,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor,panningModel:s.panningModel}),t._pannerAttr={coneInnerAngle:typeof s.pannerAttr.coneInnerAngle<"u"?s.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof s.pannerAttr.coneOuterAngle<"u"?s.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof s.pannerAttr.coneOuterGain<"u"?s.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof s.pannerAttr.distanceModel<"u"?s.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof s.pannerAttr.maxDistance<"u"?s.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof s.pannerAttr.refDistance<"u"?s.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof s.pannerAttr.rolloffFactor<"u"?s.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof s.pannerAttr.panningModel<"u"?s.pannerAttr.panningModel:t._panningModel});else return l=t._soundById(parseInt(r[0],10)),l?l._pannerAttr:t._pannerAttr;else r.length===2&&(s=r[0],o=parseInt(r[1],10));for(var f=t._getSoundIds(o),u=0;u<f.length;u++)if(l=t._soundById(f[u]),l){var d=l._pannerAttr;d={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:d.coneInnerAngle,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:d.coneOuterAngle,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:d.coneOuterGain,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:d.distanceModel,maxDistance:typeof s.maxDistance<"u"?s.maxDistance:d.maxDistance,refDistance:typeof s.refDistance<"u"?s.refDistance:d.refDistance,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:d.rolloffFactor,panningModel:typeof s.panningModel<"u"?s.panningModel:d.panningModel};var g=l._panner;g?(g.coneInnerAngle=d.coneInnerAngle,g.coneOuterAngle=d.coneOuterAngle,g.coneOuterGain=d.coneOuterGain,g.distanceModel=d.distanceModel,g.maxDistance=d.maxDistance,g.refDistance=d.refDistance,g.rolloffFactor=d.rolloffFactor,g.panningModel=d.panningModel):(l._pos||(l._pos=t._pos||[0,0,-.5]),e(l,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var r=this,s=r._parent;r._orientation=s._orientation,r._stereo=s._stereo,r._pos=s._pos,r._pannerAttr=s._pannerAttr,t.call(this),r._stereo?s.stereo(r._stereo):r._pos&&s.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var r=this,s=r._parent;return r._orientation=s._orientation,r._stereo=s._stereo,r._pos=s._pos,r._pannerAttr=s._pannerAttr,r._stereo?s.stereo(r._stereo):r._pos?s.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,s._refreshBuffer(r)),t.call(this)}}(Sound.prototype.reset);var e=function(t,r){r=r||"spatial",r==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(qr);let bt;const Cn={capture:[0,204],move:[704,316],select:[1519,153],silence:[2172,500]},ko=()=>{if(!bt){const n=Object.values(Cn).map(e=>window.btoa(`${e[0]}:${e[1]}`)).join("-");bt??(bt=new qr.Howl({src:[`/audio/sprite.mp3?v=${n}`],sprite:Cn}))}return bt},Io=n=>{ko().play(n)};function Eo(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Xe=Eo,Oo=typeof de=="object"&&de&&de.Object===Object&&de,Nr=Oo,Po=Nr,Mo=typeof self=="object"&&self&&self.Object===Object&&self,jo=Po||Mo||Function("return this")(),fe=jo,Do=fe,Lo=function(){return Do.Date.now()},xo=Lo,Ro=/\s/;function Go(n){for(var e=n.length;e--&&Ro.test(n.charAt(e)););return e}var Ho=Go,Fo=Ho,Co=/^\s+/;function Bo(n){return n&&n.slice(0,Fo(n)+1).replace(Co,"")}var qo=Bo,No=fe,Vo=No.Symbol,Ut=Vo,Bn=Ut,Vr=Object.prototype,Uo=Vr.hasOwnProperty,Wo=Vr.toString,qe=Bn?Bn.toStringTag:void 0;function Xo(n){var e=Uo.call(n,qe),t=n[qe];try{n[qe]=void 0;var r=!0}catch{}var s=Wo.call(n);return r&&(e?n[qe]=t:delete n[qe]),s}var zo=Xo,Ko=Object.prototype,Qo=Ko.toString;function Jo(n){return Qo.call(n)}var Yo=Jo,qn=Ut,Zo=zo,ea=Yo,ta="[object Null]",na="[object Undefined]",Nn=qn?qn.toStringTag:void 0;function ra(n){return n==null?n===void 0?na:ta:Nn&&Nn in Object(n)?Zo(n):ea(n)}var ze=ra;function ia(n){return n!=null&&typeof n=="object"}var Ke=ia,sa=ze,oa=Ke,aa="[object Symbol]";function la(n){return typeof n=="symbol"||oa(n)&&sa(n)==aa}var ca=la,ua=qo,Vn=Xe,fa=ca,Un=0/0,da=/^[-+]0x[0-9a-f]+$/i,_a=/^0b[01]+$/i,pa=/^0o[0-7]+$/i,ha=parseInt;function ga(n){if(typeof n=="number")return n;if(fa(n))return Un;if(Vn(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Vn(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=ua(n);var t=_a.test(n);return t||pa.test(n)?ha(n.slice(2),t?2:8):da.test(n)?Un:+n}var ma=ga,va=Xe,wt=xo,Wn=ma,ya="Expected a function",ba=Math.max,wa=Math.min;function $a(n,e,t){var r,s,o,l,f,u,d=0,g=!1,i=!1,a=!0;if(typeof n!="function")throw new TypeError(ya);e=Wn(e)||0,va(t)&&(g=!!t.leading,i="maxWait"in t,o=i?ba(Wn(t.maxWait)||0,e):o,a="trailing"in t?!!t.trailing:a);function c(I){var A=r,B=s;return r=s=void 0,d=I,l=n.apply(B,A),l}function _(I){return d=I,f=setTimeout(h,e),g?c(I):l}function p(I){var A=I-u,B=I-d,O=e-A;return i?wa(O,o-B):O}function m(I){var A=I-u,B=I-d;return u===void 0||A>=e||A<0||i&&B>=o}function h(){var I=wt();if(m(I))return y(I);f=setTimeout(h,p(I))}function y(I){return f=void 0,a&&r?c(I):(r=s=void 0,l)}function b(){f!==void 0&&clearTimeout(f),d=0,r=u=s=f=void 0}function v(){return f===void 0?l:y(wt())}function w(){var I=wt(),A=m(I);if(r=arguments,s=this,u=I,A){if(f===void 0)return _(u);if(i)return clearTimeout(f),f=setTimeout(h,e),c(u)}return f===void 0&&(f=setTimeout(h,e)),l}return w.cancel=b,w.flush=v,w}var Aa=$a,Ta=Aa,Sa=Xe,ka="Expected a function";function Ia(n,e,t){var r=!0,s=!0;if(typeof n!="function")throw new TypeError(ka);return Sa(t)&&(r="leading"in t?!!t.leading:r,s="trailing"in t?!!t.trailing:s),Ta(n,e,{leading:r,maxWait:e,trailing:s})}var Ea=Ia;const Oa=Br(Ea);function Pa(){this.__data__=[],this.size=0}var Ma=Pa;function ja(n,e){return n===e||n!==n&&e!==e}var Ur=ja,Da=Ur;function La(n,e){for(var t=n.length;t--;)if(Da(n[t][0],e))return t;return-1}var pt=La,xa=pt,Ra=Array.prototype,Ga=Ra.splice;function Ha(n){var e=this.__data__,t=xa(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():Ga.call(e,t,1),--this.size,!0}var Fa=Ha,Ca=pt;function Ba(n){var e=this.__data__,t=Ca(e,n);return t<0?void 0:e[t][1]}var qa=Ba,Na=pt;function Va(n){return Na(this.__data__,n)>-1}var Ua=Va,Wa=pt;function Xa(n,e){var t=this.__data__,r=Wa(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}var za=Xa,Ka=Ma,Qa=Fa,Ja=qa,Ya=Ua,Za=za;function xe(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}xe.prototype.clear=Ka;xe.prototype.delete=Qa;xe.prototype.get=Ja;xe.prototype.has=Ya;xe.prototype.set=Za;var ht=xe,el=ht;function tl(){this.__data__=new el,this.size=0}var nl=tl;function rl(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}var il=rl;function sl(n){return this.__data__.get(n)}var ol=sl;function al(n){return this.__data__.has(n)}var ll=al,cl=ze,ul=Xe,fl="[object AsyncFunction]",dl="[object Function]",_l="[object GeneratorFunction]",pl="[object Proxy]";function hl(n){if(!ul(n))return!1;var e=cl(n);return e==dl||e==_l||e==fl||e==pl}var Wr=hl,gl=fe,ml=gl["__core-js_shared__"],vl=ml,$t=vl,Xn=function(){var n=/[^.]+$/.exec($t&&$t.keys&&$t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function yl(n){return!!Xn&&Xn in n}var bl=yl,wl=Function.prototype,$l=wl.toString;function Al(n){if(n!=null){try{return $l.call(n)}catch{}try{return n+""}catch{}}return""}var Xr=Al,Tl=Wr,Sl=bl,kl=Xe,Il=Xr,El=/[\\^$.*+?()[\]{}|]/g,Ol=/^\[object .+?Constructor\]$/,Pl=Function.prototype,Ml=Object.prototype,jl=Pl.toString,Dl=Ml.hasOwnProperty,Ll=RegExp("^"+jl.call(Dl).replace(El,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function xl(n){if(!kl(n)||Sl(n))return!1;var e=Tl(n)?Ll:Ol;return e.test(Il(n))}var Rl=xl;function Gl(n,e){return n==null?void 0:n[e]}var Hl=Gl,Fl=Rl,Cl=Hl;function Bl(n,e){var t=Cl(n,e);return Fl(t)?t:void 0}var Re=Bl,ql=Re,Nl=fe,Vl=ql(Nl,"Map"),Wt=Vl,Ul=Re,Wl=Ul(Object,"create"),gt=Wl,zn=gt;function Xl(){this.__data__=zn?zn(null):{},this.size=0}var zl=Xl;function Kl(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var Ql=Kl,Jl=gt,Yl="__lodash_hash_undefined__",Zl=Object.prototype,ec=Zl.hasOwnProperty;function tc(n){var e=this.__data__;if(Jl){var t=e[n];return t===Yl?void 0:t}return ec.call(e,n)?e[n]:void 0}var nc=tc,rc=gt,ic=Object.prototype,sc=ic.hasOwnProperty;function oc(n){var e=this.__data__;return rc?e[n]!==void 0:sc.call(e,n)}var ac=oc,lc=gt,cc="__lodash_hash_undefined__";function uc(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=lc&&e===void 0?cc:e,this}var fc=uc,dc=zl,_c=Ql,pc=nc,hc=ac,gc=fc;function Ge(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Ge.prototype.clear=dc;Ge.prototype.delete=_c;Ge.prototype.get=pc;Ge.prototype.has=hc;Ge.prototype.set=gc;var mc=Ge,Kn=mc,vc=ht,yc=Wt;function bc(){this.size=0,this.__data__={hash:new Kn,map:new(yc||vc),string:new Kn}}var wc=bc;function $c(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}var Ac=$c,Tc=Ac;function Sc(n,e){var t=n.__data__;return Tc(e)?t[typeof e=="string"?"string":"hash"]:t.map}var mt=Sc,kc=mt;function Ic(n){var e=kc(this,n).delete(n);return this.size-=e?1:0,e}var Ec=Ic,Oc=mt;function Pc(n){return Oc(this,n).get(n)}var Mc=Pc,jc=mt;function Dc(n){return jc(this,n).has(n)}var Lc=Dc,xc=mt;function Rc(n,e){var t=xc(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}var Gc=Rc,Hc=wc,Fc=Ec,Cc=Mc,Bc=Lc,qc=Gc;function He(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}He.prototype.clear=Hc;He.prototype.delete=Fc;He.prototype.get=Cc;He.prototype.has=Bc;He.prototype.set=qc;var zr=He,Nc=ht,Vc=Wt,Uc=zr,Wc=200;function Xc(n,e){var t=this.__data__;if(t instanceof Nc){var r=t.__data__;if(!Vc||r.length<Wc-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Uc(r)}return t.set(n,e),this.size=t.size,this}var zc=Xc,Kc=ht,Qc=nl,Jc=il,Yc=ol,Zc=ll,eu=zc;function Fe(n){var e=this.__data__=new Kc(n);this.size=e.size}Fe.prototype.clear=Qc;Fe.prototype.delete=Jc;Fe.prototype.get=Yc;Fe.prototype.has=Zc;Fe.prototype.set=eu;var tu=Fe,nu="__lodash_hash_undefined__";function ru(n){return this.__data__.set(n,nu),this}var iu=ru;function su(n){return this.__data__.has(n)}var ou=su,au=zr,lu=iu,cu=ou;function ot(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new au;++e<t;)this.add(n[e])}ot.prototype.add=ot.prototype.push=lu;ot.prototype.has=cu;var uu=ot;function fu(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}var du=fu;function _u(n,e){return n.has(e)}var pu=_u,hu=uu,gu=du,mu=pu,vu=1,yu=2;function bu(n,e,t,r,s,o){var l=t&vu,f=n.length,u=e.length;if(f!=u&&!(l&&u>f))return!1;var d=o.get(n),g=o.get(e);if(d&&g)return d==e&&g==n;var i=-1,a=!0,c=t&yu?new hu:void 0;for(o.set(n,e),o.set(e,n);++i<f;){var _=n[i],p=e[i];if(r)var m=l?r(p,_,i,e,n,o):r(_,p,i,n,e,o);if(m!==void 0){if(m)continue;a=!1;break}if(c){if(!gu(e,function(h,y){if(!mu(c,y)&&(_===h||s(_,h,t,r,o)))return c.push(y)})){a=!1;break}}else if(!(_===p||s(_,p,t,r,o))){a=!1;break}}return o.delete(n),o.delete(e),a}var Kr=bu,wu=fe,$u=wu.Uint8Array,Au=$u;function Tu(n){var e=-1,t=Array(n.size);return n.forEach(function(r,s){t[++e]=[s,r]}),t}var Su=Tu;function ku(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var Iu=ku,Qn=Ut,Jn=Au,Eu=Ur,Ou=Kr,Pu=Su,Mu=Iu,ju=1,Du=2,Lu="[object Boolean]",xu="[object Date]",Ru="[object Error]",Gu="[object Map]",Hu="[object Number]",Fu="[object RegExp]",Cu="[object Set]",Bu="[object String]",qu="[object Symbol]",Nu="[object ArrayBuffer]",Vu="[object DataView]",Yn=Qn?Qn.prototype:void 0,At=Yn?Yn.valueOf:void 0;function Uu(n,e,t,r,s,o,l){switch(t){case Vu:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case Nu:return!(n.byteLength!=e.byteLength||!o(new Jn(n),new Jn(e)));case Lu:case xu:case Hu:return Eu(+n,+e);case Ru:return n.name==e.name&&n.message==e.message;case Fu:case Bu:return n==e+"";case Gu:var f=Pu;case Cu:var u=r&ju;if(f||(f=Mu),n.size!=e.size&&!u)return!1;var d=l.get(n);if(d)return d==e;r|=Du,l.set(n,e);var g=Ou(f(n),f(e),r,s,o,l);return l.delete(n),g;case qu:if(At)return At.call(n)==At.call(e)}return!1}var Wu=Uu;function Xu(n,e){for(var t=-1,r=e.length,s=n.length;++t<r;)n[s+t]=e[t];return n}var zu=Xu,Ku=Array.isArray,Xt=Ku,Qu=zu,Ju=Xt;function Yu(n,e,t){var r=e(n);return Ju(n)?r:Qu(r,t(n))}var Zu=Yu;function ef(n,e){for(var t=-1,r=n==null?0:n.length,s=0,o=[];++t<r;){var l=n[t];e(l,t,n)&&(o[s++]=l)}return o}var tf=ef;function nf(){return[]}var rf=nf,sf=tf,of=rf,af=Object.prototype,lf=af.propertyIsEnumerable,Zn=Object.getOwnPropertySymbols,cf=Zn?function(n){return n==null?[]:(n=Object(n),sf(Zn(n),function(e){return lf.call(n,e)}))}:of,uf=cf;function ff(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var df=ff,_f=ze,pf=Ke,hf="[object Arguments]";function gf(n){return pf(n)&&_f(n)==hf}var mf=gf,er=mf,vf=Ke,Qr=Object.prototype,yf=Qr.hasOwnProperty,bf=Qr.propertyIsEnumerable,wf=er(function(){return arguments}())?er:function(n){return vf(n)&&yf.call(n,"callee")&&!bf.call(n,"callee")},$f=wf,at={exports:{}};function Af(){return!1}var Tf=Af;at.exports;(function(n,e){var t=fe,r=Tf,s=e&&!e.nodeType&&e,o=s&&!0&&n&&!n.nodeType&&n,l=o&&o.exports===s,f=l?t.Buffer:void 0,u=f?f.isBuffer:void 0,d=u||r;n.exports=d})(at,at.exports);var Jr=at.exports,Sf=9007199254740991,kf=/^(?:0|[1-9]\d*)$/;function If(n,e){var t=typeof n;return e=e??Sf,!!e&&(t=="number"||t!="symbol"&&kf.test(n))&&n>-1&&n%1==0&&n<e}var Ef=If,Of=9007199254740991;function Pf(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=Of}var Yr=Pf,Mf=ze,jf=Yr,Df=Ke,Lf="[object Arguments]",xf="[object Array]",Rf="[object Boolean]",Gf="[object Date]",Hf="[object Error]",Ff="[object Function]",Cf="[object Map]",Bf="[object Number]",qf="[object Object]",Nf="[object RegExp]",Vf="[object Set]",Uf="[object String]",Wf="[object WeakMap]",Xf="[object ArrayBuffer]",zf="[object DataView]",Kf="[object Float32Array]",Qf="[object Float64Array]",Jf="[object Int8Array]",Yf="[object Int16Array]",Zf="[object Int32Array]",ed="[object Uint8Array]",td="[object Uint8ClampedArray]",nd="[object Uint16Array]",rd="[object Uint32Array]",q={};q[Kf]=q[Qf]=q[Jf]=q[Yf]=q[Zf]=q[ed]=q[td]=q[nd]=q[rd]=!0;q[Lf]=q[xf]=q[Xf]=q[Rf]=q[zf]=q[Gf]=q[Hf]=q[Ff]=q[Cf]=q[Bf]=q[qf]=q[Nf]=q[Vf]=q[Uf]=q[Wf]=!1;function id(n){return Df(n)&&jf(n.length)&&!!q[Mf(n)]}var sd=id;function od(n){return function(e){return n(e)}}var ad=od,lt={exports:{}};lt.exports;(function(n,e){var t=Nr,r=e&&!e.nodeType&&e,s=r&&!0&&n&&!n.nodeType&&n,o=s&&s.exports===r,l=o&&t.process,f=function(){try{var u=s&&s.require&&s.require("util").types;return u||l&&l.binding&&l.binding("util")}catch{}}();n.exports=f})(lt,lt.exports);var ld=lt.exports,cd=sd,ud=ad,tr=ld,nr=tr&&tr.isTypedArray,fd=nr?ud(nr):cd,Zr=fd,dd=df,_d=$f,pd=Xt,hd=Jr,gd=Ef,md=Zr,vd=Object.prototype,yd=vd.hasOwnProperty;function bd(n,e){var t=pd(n),r=!t&&_d(n),s=!t&&!r&&hd(n),o=!t&&!r&&!s&&md(n),l=t||r||s||o,f=l?dd(n.length,String):[],u=f.length;for(var d in n)(e||yd.call(n,d))&&!(l&&(d=="length"||s&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||gd(d,u)))&&f.push(d);return f}var wd=bd,$d=Object.prototype;function Ad(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||$d;return n===t}var Td=Ad;function Sd(n,e){return function(t){return n(e(t))}}var kd=Sd,Id=kd,Ed=Id(Object.keys,Object),Od=Ed,Pd=Td,Md=Od,jd=Object.prototype,Dd=jd.hasOwnProperty;function Ld(n){if(!Pd(n))return Md(n);var e=[];for(var t in Object(n))Dd.call(n,t)&&t!="constructor"&&e.push(t);return e}var xd=Ld,Rd=Wr,Gd=Yr;function Hd(n){return n!=null&&Gd(n.length)&&!Rd(n)}var Fd=Hd,Cd=wd,Bd=xd,qd=Fd;function Nd(n){return qd(n)?Cd(n):Bd(n)}var Vd=Nd,Ud=Zu,Wd=uf,Xd=Vd;function zd(n){return Ud(n,Xd,Wd)}var Kd=zd,rr=Kd,Qd=1,Jd=Object.prototype,Yd=Jd.hasOwnProperty;function Zd(n,e,t,r,s,o){var l=t&Qd,f=rr(n),u=f.length,d=rr(e),g=d.length;if(u!=g&&!l)return!1;for(var i=u;i--;){var a=f[i];if(!(l?a in e:Yd.call(e,a)))return!1}var c=o.get(n),_=o.get(e);if(c&&_)return c==e&&_==n;var p=!0;o.set(n,e),o.set(e,n);for(var m=l;++i<u;){a=f[i];var h=n[a],y=e[a];if(r)var b=l?r(y,h,a,e,n,o):r(h,y,a,n,e,o);if(!(b===void 0?h===y||s(h,y,t,r,o):b)){p=!1;break}m||(m=a=="constructor")}if(p&&!m){var v=n.constructor,w=e.constructor;v!=w&&"constructor"in n&&"constructor"in e&&!(typeof v=="function"&&v instanceof v&&typeof w=="function"&&w instanceof w)&&(p=!1)}return o.delete(n),o.delete(e),p}var e_=Zd,t_=Re,n_=fe,r_=t_(n_,"DataView"),i_=r_,s_=Re,o_=fe,a_=s_(o_,"Promise"),l_=a_,c_=Re,u_=fe,f_=c_(u_,"Set"),d_=f_,__=Re,p_=fe,h_=__(p_,"WeakMap"),g_=h_,jt=i_,Dt=Wt,Lt=l_,xt=d_,Rt=g_,ei=ze,Ce=Xr,ir="[object Map]",m_="[object Object]",sr="[object Promise]",or="[object Set]",ar="[object WeakMap]",lr="[object DataView]",v_=Ce(jt),y_=Ce(Dt),b_=Ce(Lt),w_=Ce(xt),$_=Ce(Rt),me=ei;(jt&&me(new jt(new ArrayBuffer(1)))!=lr||Dt&&me(new Dt)!=ir||Lt&&me(Lt.resolve())!=sr||xt&&me(new xt)!=or||Rt&&me(new Rt)!=ar)&&(me=function(n){var e=ei(n),t=e==m_?n.constructor:void 0,r=t?Ce(t):"";if(r)switch(r){case v_:return lr;case y_:return ir;case b_:return sr;case w_:return or;case $_:return ar}return e});var A_=me,Tt=tu,T_=Kr,S_=Wu,k_=e_,cr=A_,ur=Xt,fr=Jr,I_=Zr,E_=1,dr="[object Arguments]",_r="[object Array]",Je="[object Object]",O_=Object.prototype,pr=O_.hasOwnProperty;function P_(n,e,t,r,s,o){var l=ur(n),f=ur(e),u=l?_r:cr(n),d=f?_r:cr(e);u=u==dr?Je:u,d=d==dr?Je:d;var g=u==Je,i=d==Je,a=u==d;if(a&&fr(n)){if(!fr(e))return!1;l=!0,g=!1}if(a&&!g)return o||(o=new Tt),l||I_(n)?T_(n,e,t,r,s,o):S_(n,e,u,t,r,s,o);if(!(t&E_)){var c=g&&pr.call(n,"__wrapped__"),_=i&&pr.call(e,"__wrapped__");if(c||_){var p=c?n.value():n,m=_?e.value():e;return o||(o=new Tt),s(p,m,t,r,o)}}return a?(o||(o=new Tt),k_(n,e,t,r,s,o)):!1}var M_=P_,j_=M_,hr=Ke;function ti(n,e,t,r,s){return n===e?!0:n==null||e==null||!hr(n)&&!hr(e)?n!==n&&e!==e:j_(n,e,t,r,ti,s)}var D_=ti,L_=D_;function x_(n,e){return L_(n,e)}var R_=x_;const G_=Br(R_);function H_(n){let e,t,r={slot:"actions"};return e=new js({props:r}),n[8](e),{c(){V(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,o){W(e,s,o),t=!0},p(s,o){const l={};e.$set(l)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){k(e.$$.fragment,s),t=!1},d(s){n[8](null),X(e,s)}}}function F_(n){let e,t;return e=new ks({props:{slot:"cursor-overlays",mousePositions:n[0]}}),{c(){V(e.$$.fragment)},l(r){U(e.$$.fragment,r)},m(r,s){W(e,r,s),t=!0},p(r,s){const o={};s&1&&(o.mousePositions=r[0]),e.$set(o)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){X(e,r)}}}function C_(n){let e,t,r,s,o=n[2].log.join(`
`)+"",l,f,u=JSON.stringify(n[3],null,2)+"",d,g,i;return e=new So({props:{reportMousePosition:n[6],$$slots:{"cursor-overlays":[F_],actions:[H_]},$$scope:{ctx:n}}}),{c(){V(e.$$.fragment),t=F(),r=L("pre"),s=R(""),l=R(o),f=R(`

`),d=R(u),g=R(`
`)},l(a){U(e.$$.fragment,a),t=C(a),r=x(a,"PRE",{});var c=H(r);s=G(c,""),l=G(c,o),f=G(c,`

`),d=G(c,u),g=G(c,`
`),c.forEach($)},m(a,c){W(e,a,c),S(a,t,c),S(a,r,c),P(r,s),P(r,l),P(r,f),P(r,d),P(r,g),i=!0},p(a,[c]){const _={};c&32771&&(_.$$scope={dirty:c,ctx:a}),e.$set(_),(!i||c&4)&&o!==(o=a[2].log.join(`
`)+"")&&oe(l,o),(!i||c&8)&&u!==(u=JSON.stringify(a[3],null,2)+"")&&oe(d,u)},i(a){i||(T(e.$$.fragment,a),i=!0)},o(a){k(e.$$.fragment,a),i=!1},d(a){a&&($(t),$(r)),X(e,a)}}}function B_(n,e,t){let r,s,{data:o}=e;const l=o.machineInput,f=l.gameId,u=l.userId,d=l.hostUserId,g={},i=vs({gameId:f,userId:u,onMessage:y=>{y.type==="mouse position"?t(0,g[y.userId]=y.position,g):a.send(y)}});K(n,i,y=>t(2,r=y));const a=_s(ms({send:i.send,actions:{playSound:Io,showEmoji:({userId:y,emoji:b})=>p==null?void 0:p.showEmoji({userId:y,emoji:b})}}),{input:l}),c=Y(a.service,({context:y})=>et(y),G_);ps({gameId:f,userId:u,user:c,hostUserId:d,machine:a});const _=a.state;K(n,_,y=>t(3,s=y)),mr(()=>(i.open(),()=>{i.close()}));let p;const m=Oa(y=>{i.send({type:"mouse position",position:y})},50,{leading:!0,trailing:!0});function h(y){Gt[y?"unshift":"push"](()=>{p=y,t(1,p)})}return n.$$set=y=>{"data"in y&&t(7,o=y.data)},[g,p,r,s,i,_,m,o,h]}class X_ extends ae{constructor(e){super(),le(this,e,B_,C_,ie,{data:7})}}export{X_ as component,W_ as universal};
