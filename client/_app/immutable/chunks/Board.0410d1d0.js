import{s as K,x as E,e as M,a as q,c as S,b as I,l as Z,g as T,f as w,m as k,i as N,h as C,y as P,z as V,A,O as j,D,L,P as $,H as W,r as x,k as ee,K as se,M as te}from"./scheduler.9575fd4f.js";import{S as O,i as R,t as y,b as z,c as ne,a as oe,m as le,d as ae}from"./index.ae3d3fc3.js";import{r as X}from"./index.a8ce1c85.js";import{g as re}from"./game-context.06b850d9.js";function ie(e,t){return e===t}const de=(e,t,s=ie)=>{let o,l=t(e.getSnapshot());return X(l,h=>{const i=d=>{const a=t(d);s(l,a)||(l=a,h(a))};return i(e.getSnapshot()),o=e.subscribe(i),()=>{o.unsubscribe()}})},Y=(e,t)=>{const s=t.users.find(o=>o.id===e);if(!s)throw new Error(`The user with id ${e} was not found.`);return s},Me=(e,t)=>Y(e,t).isAdmin,fe=e=>Y(e.userId,e);function ue(e){let t,s,o="The hidden threat",l,r;const h=e[1].default,i=E(h,e,e[0],null);return{c(){t=M("div"),s=M("div"),s.textContent=o,l=q(),i&&i.c(),this.h()},l(d){t=S(d,"DIV",{class:!0});var a=I(t);s=S(a,"DIV",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-xbe4by"&&(s.textContent=o),l=T(a),i&&i.l(a),a.forEach(w),this.h()},h(){k(s,"class","title svelte-17fjqxi"),k(t,"class","header svelte-17fjqxi")},m(d,a){N(d,t,a),C(t,s),C(t,l),i&&i.m(t,null),r=!0},p(d,[a]){i&&i.p&&(!r||a&1)&&P(i,h,d,d[0],r?A(h,d[0],a,null):V(d[0]),null)},i(d){r||(y(i,d),r=!0)},o(d){z(i,d),r=!1},d(d){d&&w(t),i&&i.d(d)}}}function ce(e,t,s){let{$$slots:o={},$$scope:l}=t;return e.$$set=r=>{"$$scope"in r&&s(0,l=r.$$scope)},[l,o]}class _e extends O{constructor(t){super(),R(this,t,ce,ue,K,{})}}const he=e=>({}),U=e=>({}),me=e=>({}),G=e=>({});function pe(e){let t;const s=e[13].header,o=E(s,e,e[17],G);return{c(){o&&o.c()},l(l){o&&o.l(l)},m(l,r){o&&o.m(l,r),t=!0},p(l,r){o&&o.p&&(!t||r&131072)&&P(o,s,l,l[17],t?A(s,l[17],r,me):V(l[17]),G)},i(l){t||(y(o,l),t=!0)},o(l){z(o,l),t=!1},d(l){o&&o.d(l)}}}function ve(e){let t,s,o,l,r,h,i,d,a,b,v;j(e[14]),o=new _e({props:{$$slots:{default:[pe]},$$scope:{ctx:e}}});const p=e[13].default,f=E(p,e,e[17],null),g=e[13].overlays,c=E(g,e,e[17],U);return{c(){t=M("div"),s=M("div"),ne(o.$$.fragment),l=q(),r=M("div"),f&&f.c(),h=q(),c&&c.c(),this.h()},l(n){t=S(n,"DIV",{class:!0});var _=I(t);s=S(_,"DIV",{class:!0});var m=I(s);oe(o.$$.fragment,m),l=T(m),r=S(m,"DIV",{class:!0});var B=I(r);f&&f.l(B),B.forEach(w),h=T(m),c&&c.l(m),m.forEach(w),_.forEach(w),this.h()},h(){k(r,"class","content svelte-ovklwv"),D(r,"padded",e[1]),k(s,"class",i="board "+(e[8]?`side-${e[8]}`:"")+" svelte-ovklwv"),j(()=>e[16].call(s)),D(s,"backdrop",e[0]),k(t,"class","board-wrapper svelte-ovklwv"),L(t,"--board-scale",e[7])},m(n,_){N(n,t,_),C(t,s),le(o,s,null),C(s,l),C(s,r),f&&f.m(r,null),C(s,h),c&&c.m(s,null),e[15](s),d=$(s,e[16].bind(s)),a=!0,b||(v=[W(window,"resize",e[11]),W(window,"resize",e[14]),W(s,"mousemove",e[10])],b=!0)},p(n,[_]){const m={};_&131072&&(m.$$scope={dirty:_,ctx:n}),o.$set(m),f&&f.p&&(!a||_&131072)&&P(f,p,n,n[17],a?A(p,n[17],_,null):V(n[17]),null),(!a||_&2)&&D(r,"padded",n[1]),c&&c.p&&(!a||_&131072)&&P(c,g,n,n[17],a?A(g,n[17],_,he):V(n[17]),U),(!a||_&256&&i!==(i="board "+(n[8]?`side-${n[8]}`:"")+" svelte-ovklwv"))&&k(s,"class",i),(!a||_&257)&&D(s,"backdrop",n[0]),_&128&&L(t,"--board-scale",n[7])},i(n){a||(y(o.$$.fragment,n),y(f,n),y(c,n),a=!0)},o(n){z(o.$$.fragment,n),z(f,n),z(c,n),a=!1},d(n){n&&w(t),ae(o),f&&f.d(n),c&&c.d(n),e[15](null),d(),b=!1,x(v)}}}function ge(e,t,s){let o,{$$slots:l={},$$scope:r}=t,{reportMousePosition:h=void 0}=t,{showBackdrop:i=!1}=t,{paddedContent:d=!1}=t;const a=re(),b=a?de(a.machine.service,({context:u})=>{const H=fe(u);if(H.isAdmin)return H.side}):X(void 0);ee(e,b,u=>s(8,o=u));let v,p=1,f=1,g=1,c=1,n=1;const _=u=>{if(!h)return;const H=(u.clientX-v.offsetLeft)/p,Q=(u.clientY-v.offsetTop)/f;h([(H-(1-n)/2)/n,(Q-(1-n)/2)/n])},m=()=>{s(7,n=Math.min(g/(p+20),c/(f+20))),n>=1.3?s(7,n=1.3):s(7,n=Math.min(n,1))};se(m);function B(){s(5,g=window.innerWidth),s(6,c=window.innerHeight)}function F(u){te[u?"unshift":"push"](()=>{v=u,s(2,v)})}function J(){p=this.clientWidth,f=this.clientHeight,s(3,p),s(4,f)}return e.$$set=u=>{"reportMousePosition"in u&&s(12,h=u.reportMousePosition),"showBackdrop"in u&&s(0,i=u.showBackdrop),"paddedContent"in u&&s(1,d=u.paddedContent),"$$scope"in u&&s(17,r=u.$$scope)},[i,d,v,p,f,g,c,n,o,b,_,m,h,l,B,F,J,r]}class Se extends O{constructor(t){super(),R(this,t,ge,ve,K,{reportMousePosition:12,showBackdrop:0,paddedContent:1})}}export{Se as B,de as a,Y as b,fe as g,Me as u};
