import{s as K,x as E,e as M,a as q,c as S,b as I,l as Z,g as T,f as w,m as k,i as N,h as C,y as P,z as V,A,O as j,D,L,P as $,H as W,r as x,k as ee,K as se,M as te}from"./scheduler.9575fd4f.js";import{S as O,i as R,t as y,b as z,c as ne,a as oe,m as ae,d as le}from"./index.ae3d3fc3.js";import{r as X}from"./index.a8ce1c85.js";import{g as re}from"./game-context.06b850d9.js";function ie(e,t){return e===t}const de=(e,t,s=ie)=>{let o,a=t(e.getSnapshot());return X(a,h=>{const i=d=>{const l=t(d);s(a,l)||(a=l,h(l))};return i(e.getSnapshot()),o=e.subscribe(i),()=>{o.unsubscribe()}})},Y=(e,t)=>{const s=t.users.find(o=>o.id===e);if(!s)throw new Error(`The user with id ${e} was not found.`);return s},Me=(e,t)=>Y(e,t).isAdmin,ue=e=>Y(e.userId,e);function fe(e){let t,s,o="The hidden threat",a,r;const h=e[1].default,i=E(h,e,e[0],null);return{c(){t=M("div"),s=M("div"),s.textContent=o,a=q(),i&&i.c(),this.h()},l(d){t=S(d,"DIV",{class:!0});var l=I(t);s=S(l,"DIV",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-xbe4by"&&(s.textContent=o),a=T(l),i&&i.l(l),l.forEach(w),this.h()},h(){k(s,"class","title svelte-17fjqxi"),k(t,"class","header svelte-17fjqxi")},m(d,l){N(d,t,l),C(t,s),C(t,a),i&&i.m(t,null),r=!0},p(d,[l]){i&&i.p&&(!r||l&1)&&P(i,h,d,d[0],r?A(h,d[0],l,null):V(d[0]),null)},i(d){r||(y(i,d),r=!0)},o(d){z(i,d),r=!1},d(d){d&&w(t),i&&i.d(d)}}}function ce(e,t,s){let{$$slots:o={},$$scope:a}=t;return e.$$set=r=>{"$$scope"in r&&s(0,a=r.$$scope)},[a,o]}class _e extends O{constructor(t){super(),R(this,t,ce,fe,K,{})}}const he=e=>({}),U=e=>({}),me=e=>({}),G=e=>({});function pe(e){let t;const s=e[13].header,o=E(s,e,e[17],G);return{c(){o&&o.c()},l(a){o&&o.l(a)},m(a,r){o&&o.m(a,r),t=!0},p(a,r){o&&o.p&&(!t||r&131072)&&P(o,s,a,a[17],t?A(s,a[17],r,me):V(a[17]),G)},i(a){t||(y(o,a),t=!0)},o(a){z(o,a),t=!1},d(a){o&&o.d(a)}}}function ve(e){let t,s,o,a,r,h,i,d,l,b,v;j(e[14]),o=new _e({props:{$$slots:{default:[pe]},$$scope:{ctx:e}}});const p=e[13].default,u=E(p,e,e[17],null),g=e[13].overlays,c=E(g,e,e[17],U);return{c(){t=M("div"),s=M("div"),ne(o.$$.fragment),a=q(),r=M("div"),u&&u.c(),h=q(),c&&c.c(),this.h()},l(n){t=S(n,"DIV",{class:!0});var _=I(t);s=S(_,"DIV",{class:!0});var m=I(s);oe(o.$$.fragment,m),a=T(m),r=S(m,"DIV",{class:!0});var B=I(r);u&&u.l(B),B.forEach(w),h=T(m),c&&c.l(m),m.forEach(w),_.forEach(w),this.h()},h(){k(r,"class","content svelte-17ghkvu"),D(r,"padded",e[1]),k(s,"class",i="board "+(e[8]?`side-${e[8]}`:"")+" svelte-17ghkvu"),j(()=>e[16].call(s)),D(s,"backdrop",e[0]),k(t,"class","board-wrapper svelte-17ghkvu"),L(t,"--board-scale",e[7])},m(n,_){N(n,t,_),C(t,s),ae(o,s,null),C(s,a),C(s,r),u&&u.m(r,null),C(s,h),c&&c.m(s,null),e[15](s),d=$(s,e[16].bind(s)),l=!0,b||(v=[W(window,"resize",e[11]),W(window,"resize",e[14]),W(s,"mousemove",e[10])],b=!0)},p(n,[_]){const m={};_&131072&&(m.$$scope={dirty:_,ctx:n}),o.$set(m),u&&u.p&&(!l||_&131072)&&P(u,p,n,n[17],l?A(p,n[17],_,null):V(n[17]),null),(!l||_&2)&&D(r,"padded",n[1]),c&&c.p&&(!l||_&131072)&&P(c,g,n,n[17],l?A(g,n[17],_,he):V(n[17]),U),(!l||_&256&&i!==(i="board "+(n[8]?`side-${n[8]}`:"")+" svelte-17ghkvu"))&&k(s,"class",i),(!l||_&257)&&D(s,"backdrop",n[0]),_&128&&L(t,"--board-scale",n[7])},i(n){l||(y(o.$$.fragment,n),y(u,n),y(c,n),l=!0)},o(n){z(o.$$.fragment,n),z(u,n),z(c,n),l=!1},d(n){n&&w(t),le(o),u&&u.d(n),c&&c.d(n),e[15](null),d(),b=!1,x(v)}}}function ge(e,t,s){let o,{$$slots:a={},$$scope:r}=t,{reportMousePosition:h=void 0}=t,{showBackdrop:i=!1}=t,{paddedContent:d=!1}=t;const l=re(),b=l?de(l.machine.service,({context:f})=>{const H=ue(f);if(H.isAdmin)return H.side}):X(void 0);ee(e,b,f=>s(8,o=f));let v,p=1,u=1,g=1,c=1,n=1;const _=f=>{if(!h)return;const H=(f.clientX-v.offsetLeft)/p,Q=(f.clientY-v.offsetTop)/u;h([(H-(1-n)/2)/n,(Q-(1-n)/2)/n])},m=()=>{s(7,n=Math.min(g/(p+20),c/(u+20))),n>=1.3?s(7,n=1.3):s(7,n=Math.min(n,1))};se(m);function B(){s(5,g=window.innerWidth),s(6,c=window.innerHeight)}function F(f){te[f?"unshift":"push"](()=>{v=f,s(2,v)})}function J(){p=this.clientWidth,u=this.clientHeight,s(3,p),s(4,u)}return e.$$set=f=>{"reportMousePosition"in f&&s(12,h=f.reportMousePosition),"showBackdrop"in f&&s(0,i=f.showBackdrop),"paddedContent"in f&&s(1,d=f.paddedContent),"$$scope"in f&&s(17,r=f.$$scope)},[i,d,v,p,u,g,c,n,o,b,_,m,h,a,B,F,J,r]}class Se extends O{constructor(t){super(),R(this,t,ge,ve,K,{reportMousePosition:12,showBackdrop:0,paddedContent:1})}}export{Se as B,de as a,Y as b,ue as g,Me as u};
